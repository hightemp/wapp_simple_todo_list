var Spreadsheet;(()=>{"use strict";var e={176:(e,t,s)=>{s.d(t,{Z:()=>p});var i=s(81),n=s.n(i),r=s(645),l=s.n(r),o=s(667),a=s.n(o),h=new URL(s(794),s.b),c=l()(n()),d=a()(h);c.push([e.id,"body {\n  margin: 0;\n}\n.x-spreadsheet {\n  font-size: 13px;\n  line-height: normal;\n  user-select: none;\n  -moz-user-select: none;\n  font-family: 'Lato', 'Source Sans Pro', Roboto, Helvetica, Arial, sans-serif;\n  box-sizing: content-box;\n  background: #fff;\n  -webkit-font-smoothing: antialiased;\n}\n.x-spreadsheet textarea {\n  font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;\n}\n.x-spreadsheet-sheet {\n  position: relative;\n  overflow: hidden;\n}\n.x-spreadsheet-table {\n  vertical-align: bottom;\n}\n.x-spreadsheet-tooltip {\n  font-family: inherit;\n  position: absolute;\n  padding: 5px 10px;\n  color: #fff;\n  border-radius: 1px;\n  background: #000000;\n  font-size: 12px;\n  z-index: 201;\n}\n.x-spreadsheet-tooltip:before {\n  pointer-events: none;\n  position: absolute;\n  left: calc(50% - 4px);\n  top: -4px;\n  content: \"\";\n  width: 8px;\n  height: 8px;\n  background: inherit;\n  -webkit-transform: rotate(45deg);\n  transform: rotate(45deg);\n  z-index: 1;\n  box-shadow: 1px 1px 3px -1px rgba(0, 0, 0, 0.3);\n}\n.x-spreadsheet-color-palette {\n  padding: 5px;\n}\n.x-spreadsheet-color-palette table {\n  margin: 0;\n  padding: 0;\n  border-collapse: separate;\n  border-spacing: 2;\n  background: #fff;\n}\n.x-spreadsheet-color-palette table td {\n  margin: 0;\n  cursor: pointer;\n  border: 1px solid transparent;\n}\n.x-spreadsheet-color-palette table td:hover {\n  border-color: #ddd;\n}\n.x-spreadsheet-color-palette table td .x-spreadsheet-color-palette-cell {\n  width: 16px;\n  height: 16px;\n}\n.x-spreadsheet-border-palette {\n  padding: 6px;\n}\n.x-spreadsheet-border-palette table {\n  margin: 0;\n  padding: 0;\n  border-collapse: separate;\n  border-spacing: 0;\n  background: #fff;\n  table-layout: fixed;\n}\n.x-spreadsheet-border-palette table td {\n  margin: 0;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left {\n  border-right: 1px solid #eee;\n  padding-right: 6px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell {\n  width: 30px;\n  height: 30px;\n  cursor: pointer;\n  text-align: center;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell .x-spreadsheet-icon-img {\n  opacity: 0.8;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell:hover {\n  background-color: #eee;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right {\n  padding-left: 6px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right .x-spreadsheet-toolbar-btn {\n  margin-top: 0;\n  margin-bottom: 3px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right .x-spreadsheet-line-type {\n  position: relative;\n  left: 0;\n  top: -3px;\n}\n.x-spreadsheet-dropdown {\n  position: relative;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-content {\n  position: absolute;\n  z-index: 200;\n  background: #fff;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n}\n.x-spreadsheet-dropdown.bottom-left .x-spreadsheet-dropdown-content {\n  top: calc(100% + 5px);\n  left: 0;\n}\n.x-spreadsheet-dropdown.bottom-right .x-spreadsheet-dropdown-content {\n  top: calc(100% + 5px);\n  right: 0;\n}\n.x-spreadsheet-dropdown.top-left .x-spreadsheet-dropdown-content {\n  bottom: calc(100% + 5px);\n  left: 0;\n}\n.x-spreadsheet-dropdown.top-right .x-spreadsheet-dropdown-content {\n  bottom: calc(100% + 5px);\n  right: 0;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-title {\n  padding: 0 5px;\n  display: inline-block;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-left {\n  margin-left: 4px;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right {\n  width: 10px;\n  margin-right: 4px;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right .arrow-down {\n  left: -130px;\n}\n/* resizer **/\n.x-spreadsheet-resizer {\n  position: absolute;\n  z-index: 11;\n}\n.x-spreadsheet-resizer .x-spreadsheet-resizer-hover {\n  background-color: rgba(75, 137, 255, 0.25);\n}\n.x-spreadsheet-resizer .x-spreadsheet-resizer-line {\n  position: absolute;\n}\n.x-spreadsheet-resizer.horizontal {\n  cursor: row-resize;\n}\n.x-spreadsheet-resizer.horizontal .x-spreadsheet-resizer-line {\n  border-bottom: 2px dashed #4b89ff;\n  left: 0;\n  bottom: 0;\n}\n.x-spreadsheet-resizer.vertical {\n  cursor: col-resize;\n}\n.x-spreadsheet-resizer.vertical .x-spreadsheet-resizer-line {\n  border-right: 2px dashed #4b89ff;\n  top: 0;\n  right: 0;\n}\n/* scrollbar */\n.x-spreadsheet-scrollbar {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  background-color: #f4f5f8;\n  opacity: 0.9;\n  z-index: 12;\n}\n.x-spreadsheet-scrollbar.horizontal {\n  right: 15px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n}\n.x-spreadsheet-scrollbar.horizontal > div {\n  height: 1px;\n  background: #ddd;\n}\n.x-spreadsheet-scrollbar.vertical {\n  bottom: 15px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.x-spreadsheet-scrollbar.vertical > div {\n  width: 1px;\n  background: #ddd;\n}\n/* @{css-prefix}-overlayer */\n.x-spreadsheet-overlayer {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 10;\n}\n.x-spreadsheet-overlayer .x-spreadsheet-overlayer-content {\n  position: absolute;\n  overflow: hidden;\n  pointer-events: none;\n  width: 100%;\n  height: 100%;\n}\n.x-spreadsheet-editor,\n.x-spreadsheet-selector {\n  box-sizing: content-box;\n  position: absolute;\n  overflow: hidden;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n/* @{css-prefix}-selector */\n.x-spreadsheet-selector .hide-input {\n  position: absolute;\n  z-index: 0;\n}\n.x-spreadsheet-selector .hide-input input {\n  padding: 0;\n  width: 0;\n  border: none!important;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-area {\n  position: absolute;\n  border: 2px solid #4b89ff;\n  background: rgba(75, 137, 255, 0.1);\n  z-index: 5;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-clipboard,\n.x-spreadsheet-selector .x-spreadsheet-selector-autofill {\n  position: absolute;\n  background: transparent;\n  z-index: 100;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-clipboard {\n  border: 2px dashed #4b89ff;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-autofill {\n  border: 1px dashed rgba(0, 0, 0, 0.45);\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-corner {\n  pointer-events: auto;\n  position: absolute;\n  cursor: crosshair;\n  font-size: 0;\n  height: 5px;\n  width: 5px;\n  right: -5px;\n  bottom: -5px;\n  border: 2px solid #ffffff;\n  background: #4b89ff;\n}\n.x-spreadsheet-editor {\n  z-index: 20;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area {\n  position: absolute;\n  text-align: left;\n  border: 2px solid #4b89ff;\n  line-height: 0;\n  z-index: 100;\n  pointer-events: auto;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area textarea {\n  box-sizing: content-box;\n  border: none;\n  padding: 0 3px;\n  outline: none;\n  resize: none;\n  text-align: start;\n  overflow-y: hidden;\n  font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;\n  color: inherit;\n  white-space: normal;\n  word-wrap: break-word;\n  line-height: 22px;\n  margin: 0;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area .textline {\n  overflow: hidden;\n  visibility: hidden;\n  position: fixed;\n  top: 0;\n  left: 0;\n}\n.x-spreadsheet-item {\n  user-select: none;\n  background: 0;\n  border: 1px solid transparent;\n  outline: none;\n  height: 26px;\n  color: rgba(0, 0, 0, 0.9);\n  line-height: 26px;\n  list-style: none;\n  padding: 2px 10px;\n  cursor: default;\n  text-align: left;\n  overflow: hidden;\n}\n.x-spreadsheet-item.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-item:hover,\n.x-spreadsheet-item.active {\n  background: rgba(0, 0, 0, 0.05);\n}\n.x-spreadsheet-item.divider {\n  height: 0;\n  padding: 0;\n  margin: 5px 0;\n  border: none;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n}\n.x-spreadsheet-item .label {\n  float: right;\n  opacity: 0.65;\n  font-size: 1em;\n}\n.x-spreadsheet-item.state,\n.x-spreadsheet-header.state {\n  padding-left: 35px!important;\n  position: relative;\n}\n.x-spreadsheet-item.state:before,\n.x-spreadsheet-header.state:before {\n  content: '';\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  left: 12px;\n  top: calc(50% - 5px);\n  background: rgba(0, 0, 0, 0.08);\n  border-radius: 2px;\n}\n.x-spreadsheet-item.state.checked:before,\n.x-spreadsheet-header.state.checked:before {\n  background: #4b89ff;\n}\n.x-spreadsheet-checkbox {\n  position: relative;\n  display: inline-block;\n  backface-visibility: hidden;\n  outline: 0;\n  vertical-align: baseline;\n  font-style: normal;\n  font-size: 1rem;\n  line-height: 1em;\n}\n.x-spreadsheet-checkbox > input {\n  position: absolute;\n  top: 0;\n  left: 0;\n  opacity: 0!important;\n  outline: 0;\n  z-index: -1;\n}\n.x-spreadsheet-suggest,\n.x-spreadsheet-contextmenu,\n.x-spreadsheet-sort-filter {\n  position: absolute;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n  background: #fff;\n  z-index: 100;\n  width: 260px;\n  pointer-events: auto;\n  overflow: auto;\n}\n.x-spreadsheet-suggest {\n  width: 200px;\n}\n.x-spreadsheet-filter {\n  border: 1px solid #e9e9e9;\n  font-size: 12px;\n  margin: 10px;\n}\n.x-spreadsheet-filter .x-spreadsheet-header {\n  padding: 0.5em 0.75em;\n  background: #f8f8f9;\n  border-bottom: 1px solid #e9e9e9;\n  border-left: 1px solid transparent;\n}\n.x-spreadsheet-filter .x-spreadsheet-body {\n  height: 200px;\n  overflow-y: auto;\n}\n.x-spreadsheet-filter .x-spreadsheet-body .x-spreadsheet-item {\n  height: 20px;\n  line-height: 20px;\n}\n.x-spreadsheet-sort-filter .x-spreadsheet-buttons {\n  margin: 10px;\n}\n.x-spreadsheet-toolbar,\n.x-spreadsheet-bottombar {\n  height: 40px;\n  padding: 0 30px;\n  text-align: left;\n  background: #f5f6f7;\n  display: flex;\n}\n.x-spreadsheet-bottombar {\n  position: relative;\n  border-top: 1px solid #e0e2e4;\n}\n.x-spreadsheet-bottombar .x-spreadsheet-menu > li {\n  line-height: 40px;\n  height: 40px;\n  padding-top: 0;\n  padding-bottom: 0;\n  vertical-align: middle;\n  border-right: 1px solid #e8eaed;\n}\n.x-spreadsheet-menu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  user-select: none;\n}\n.x-spreadsheet-menu > li {\n  float: left;\n  line-height: 1.25em;\n  padding: 0.785em 1em;\n  margin: 0;\n  vertical-align: middle;\n  text-align: left;\n  font-weight: 400;\n  color: #80868b;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: all 0.3s;\n  font-weight: bold;\n}\n.x-spreadsheet-menu > li.active {\n  background-color: #fff;\n  color: rgba(0, 0, 0, 0.65);\n}\n.x-spreadsheet-menu > li .x-spreadsheet-icon {\n  margin: 0 6px;\n}\n.x-spreadsheet-menu > li .x-spreadsheet-icon .x-spreadsheet-icon-img:hover {\n  opacity: 0.85;\n}\n.x-spreadsheet-menu > li .x-spreadsheet-dropdown {\n  display: inline-block;\n}\n.x-spreadsheet-toolbar {\n  border-bottom: 1px solid #e0e2e4;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btns {\n  display: inline-flex;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more {\n  padding: 0 6px 6px;\n  text-align: left;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more .x-spreadsheet-toolbar-divider {\n  margin-top: 0;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn {\n  flex: 0 0 auto;\n  display: inline-block;\n  border: 1px solid transparent;\n  height: 26px;\n  line-height: 26px;\n  min-width: 26px;\n  margin: 6px 1px 0;\n  padding: 0;\n  text-align: center;\n  border-radius: 2px;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn:hover,\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.active {\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-toolbar-divider {\n  display: inline-block;\n  border-right: 1px solid #e0e2e4;\n  width: 0;\n  vertical-align: middle;\n  height: 18px;\n  margin: 12px 3px 0;\n}\n.x-spreadsheet-print {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 100;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.x-spreadsheet-print-bar {\n  background: #424242;\n  height: 60px;\n  line-height: 60px;\n  padding: 0 30px;\n}\n.x-spreadsheet-print-bar .-title {\n  color: #fff;\n  font-weight: bold;\n  font-size: 1.2em;\n  float: left;\n}\n.x-spreadsheet-print-bar .-right {\n  float: right;\n  margin-top: 12px;\n}\n.x-spreadsheet-print-content {\n  display: flex;\n  flex: auto;\n  flex-direction: row;\n  background: #d0d0d0;\n  height: calc(100% - 60px);\n}\n.x-spreadsheet-print-content .-sider {\n  flex: 0 0 300px;\n  width: 300px;\n  border-left: 2px solid #ccc;\n  background: #fff;\n}\n.x-spreadsheet-print-content .-content {\n  flex: auto;\n  overflow-x: auto;\n  overflow-y: scroll;\n  height: 100%;\n}\n.x-spreadsheet-canvas-card-wraper {\n  margin: 40px 20px;\n}\n.x-spreadsheet-canvas-card {\n  background: #fff;\n  margin: auto;\n  page-break-before: auto;\n  page-break-after: always;\n  box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 3px rgba(0, 0, 0, 0.12), 0 4px 5px 0 rgba(0, 0, 0, 0.2);\n}\n.x-spreadsheet-calendar {\n  color: rgba(0, 0, 0, 0.65);\n  background: #ffffff;\n  user-select: none;\n}\n.x-spreadsheet-calendar .calendar-header {\n  font-weight: 700;\n  line-height: 30px;\n  text-align: center;\n  width: 100%;\n  float: left;\n  background: #f9fafb;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-left {\n  padding-left: 5px;\n  float: left;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right {\n  float: right;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right a {\n  padding: 3px 0;\n  margin-right: 2px;\n  border-radius: 2px;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right a:hover {\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-calendar .calendar-body {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\n.x-spreadsheet-calendar .calendar-body th,\n.x-spreadsheet-calendar .calendar-body td {\n  width: 100%/7;\n  min-width: 32px;\n  text-align: center;\n  font-weight: 700;\n  line-height: 30px;\n  padding: 0;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell:hover {\n  background: #ecf6fd;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell.active,\n.x-spreadsheet-calendar .calendar-body td > .cell.active:hover {\n  background: #ecf6fd;\n  color: #2185D0;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-datepicker {\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);\n  position: absolute;\n  left: 0;\n  top: calc(100% + 5px);\n  z-index: 10;\n  width: auto;\n}\n.x-spreadsheet-buttons {\n  display: flex;\n  justify-content: flex-end;\n}\n.x-spreadsheet-buttons .x-spreadsheet-button {\n  margin-left: 8px;\n}\n.x-spreadsheet-button {\n  display: inline-block;\n  border-radius: 3px;\n  line-height: 1em;\n  min-height: 1em;\n  white-space: nowrap;\n  text-align: center;\n  cursor: pointer;\n  font-size: 1em;\n  font-weight: 700;\n  padding: 0.75em 1em;\n  color: rgba(0, 0, 0, 0.6);\n  background: #E0E1E2;\n  text-decoration: none;\n  font-family: \"Lato\", \"proxima-nova\", \"Helvetica Neue\", Arial, sans-serif;\n  outline: none;\n  vertical-align: baseline;\n  zoom: 1;\n  user-select: none;\n  transition: all 0.1s linear;\n}\n.x-spreadsheet-button.active,\n.x-spreadsheet-button:hover {\n  background-color: #C0C1C2;\n  color: rgba(0, 0, 0, 0.8);\n}\n.x-spreadsheet-button.primary {\n  color: #fff;\n  background-color: #2185D0;\n}\n.x-spreadsheet-button.primary:hover,\n.x-spreadsheet-button.primary.active {\n  color: #fff;\n  background-color: #1678c2;\n}\n.x-spreadsheet-form-input {\n  font-size: 1em;\n  position: relative;\n  font-weight: 400;\n  display: inline-flex;\n  color: rgba(0, 0, 0, 0.87);\n}\n.x-spreadsheet-form-input input {\n  z-index: 1;\n  margin: 0;\n  max-width: 100%;\n  flex: 1 0 auto;\n  outline: 0;\n  -webkit-tap-highlight-color: rgba(255, 255, 255, 0);\n  text-align: left;\n  line-height: 30px;\n  height: 30px;\n  padding: 0 8px;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 3px;\n  transition: box-shadow 0.1s ease, border-color 0.1s ease;\n  box-shadow: inset 0 1px 2px hsla(0, 0%, 4%, 0.06);\n}\n.x-spreadsheet-form-input input:focus {\n  border-color: #4b89ff;\n  box-shadow: inset 0 1px 2px rgba(75, 137, 255, 0.2);\n}\n.x-spreadsheet-form-select {\n  position: relative;\n  display: inline-block;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 2px;\n  cursor: pointer;\n  color: rgba(0, 0, 0, 0.87);\n  user-select: none;\n  box-shadow: inset 0 1px 2px hsla(0, 0%, 4%, 0.06);\n}\n.x-spreadsheet-form-select .input-text {\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  min-width: 60px;\n  width: auto;\n  height: 30px;\n  line-height: 30px;\n  padding: 0 8px;\n}\n.x-spreadsheet-form-fields {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n.x-spreadsheet-form-fields .x-spreadsheet-form-field {\n  flex: 0 1 auto;\n}\n.x-spreadsheet-form-fields .x-spreadsheet-form-field .label {\n  display: inline-block;\n  margin: 0 10px 0 0;\n}\n.x-spreadsheet-form-field {\n  display: block;\n  vertical-align: middle;\n  margin-left: 10px;\n  margin-bottom: 10px;\n}\n.x-spreadsheet-form-field:first-child {\n  margin-left: 0;\n}\n.x-spreadsheet-form-field.error .x-spreadsheet-form-select,\n.x-spreadsheet-form-field.error input {\n  border-color: #f04134;\n}\n.x-spreadsheet-form-field .tip {\n  color: #f04134;\n  font-size: 0.9em;\n}\n.x-spreadsheet-dimmer {\n  display: none;\n  position: absolute;\n  top: 0 !important;\n  left: 0 !important;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  vertical-align: middle;\n  background-color: rgba(0, 0, 0, 0.6);\n  opacity: 0;\n  -webkit-animation-fill-mode: both;\n  animation-fill-mode: both;\n  -webkit-animation-duration: 0.5s;\n  animation-duration: 0.5s;\n  transition: background-color 0.5s linear;\n  user-select: none;\n  z-index: 1000;\n}\n.x-spreadsheet-dimmer.active {\n  display: block;\n  opacity: 1;\n}\nform fieldset {\n  border: none;\n}\nform fieldset label {\n  display: block;\n  margin-bottom: 0.5em;\n  font-size: 1em;\n  color: #666;\n}\nform fieldset select {\n  font-size: 1.1em;\n  width: 100%;\n  background-color: #fff;\n  border: none;\n  border-bottom: 2px solid #ddd;\n  padding: 0.5em 0.85em;\n  border-radius: 2px;\n}\n.x-spreadsheet-modal,\n.x-spreadsheet-toast {\n  font-size: 13px;\n  position: fixed;\n  z-index: 1001;\n  text-align: left;\n  line-height: 1.25em;\n  min-width: 360px;\n  color: rgba(0, 0, 0, 0.87);\n  font-family: 'Lato', 'Source Sans Pro', Roboto, Helvetica, Arial, sans-serif;\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  background-color: #fff;\n  background-clip: padding-box;\n  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 8px;\n}\n.x-spreadsheet-toast {\n  background-color: rgba(255, 255, 255, 0.85);\n}\n.x-spreadsheet-modal-header,\n.x-spreadsheet-toast-header {\n  font-weight: 600;\n  background-clip: padding-box;\n  background-color: rgba(255, 255, 255, 0.85);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n  border-radius: 4px 4px 0 0;\n}\n.x-spreadsheet-modal-header .x-spreadsheet-icon,\n.x-spreadsheet-toast-header .x-spreadsheet-icon {\n  position: absolute;\n  right: 0.8em;\n  top: 0.65em;\n  border-radius: 18px;\n}\n.x-spreadsheet-modal-header .x-spreadsheet-icon:hover,\n.x-spreadsheet-toast-header .x-spreadsheet-icon:hover {\n  opacity: 1;\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-toast-header {\n  color: #F2711C;\n}\n.x-spreadsheet-modal-header {\n  border-bottom: 1px solid #e0e2e4;\n  background: rgba(0, 0, 0, 0.08);\n  font-size: 1.0785em;\n}\n.x-spreadsheet-modal-header,\n.x-spreadsheet-modal-content,\n.x-spreadsheet-toast-header,\n.x-spreadsheet-toast-content {\n  padding: 0.75em 1em;\n}\n@media screen and (min-width: 320px) and (max-width: 480px) {\n  .x-spreadsheet-toolbar {\n    display: none;\n  }\n}\n.x-spreadsheet-icon {\n  width: 18px;\n  height: 18px;\n  margin: 1px 1px 2px 1px;\n  text-align: center;\n  vertical-align: middle;\n  user-select: none;\n  overflow: hidden;\n  position: relative;\n  display: inline-block;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img {\n  background-image: url("+d+");\n  position: absolute;\n  width: 262px;\n  height: 444px;\n  opacity: 0.56;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.undo {\n  left: 0;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.redo {\n  left: -18px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.print {\n  left: -36px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.paintformat {\n  left: -54px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.clearformat {\n  left: -72px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.font-bold {\n  left: -90px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.font-italic {\n  left: -108px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.underline {\n  left: -126px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.strike {\n  left: -144px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.color {\n  left: -162px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.bgcolor {\n  left: -180px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.merge {\n  left: -198px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-left {\n  left: -216px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-center {\n  left: -234px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-right {\n  left: 0;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-top {\n  left: -18px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-middle {\n  left: -36px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-bottom {\n  left: -54px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.textwrap {\n  left: -72px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.autofilter {\n  left: -90px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.formula {\n  left: -108px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-down {\n  left: -126px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-right {\n  left: -144px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.link {\n  left: -162px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chart {\n  left: -180px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.freeze {\n  left: -198px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.ellipsis {\n  left: -216px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.add {\n  left: -234px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-all {\n  left: 0;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-inside {\n  left: -18px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-horizontal {\n  left: -36px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-vertical {\n  left: -54px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-outside {\n  left: -72px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-left {\n  left: -90px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-top {\n  left: -108px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-right {\n  left: -126px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-bottom {\n  left: -144px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-none {\n  left: -162px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.line-color {\n  left: -180px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.line-type {\n  left: -198px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.close {\n  left: -234px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-down {\n  left: 0;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-up {\n  left: -18px;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-left {\n  left: -36px;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-right {\n  left: -54px;\n  top: -54px;\n}\n",""]);const p=c},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",i=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),i&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),i&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,i,n,r){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(i)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(l[a]=!0)}for(var h=0;h<e.length;h++){var c=[].concat(e[h]);i&&l[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),s&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=s):c[2]=s),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function s(e){for(var s=-1,i=0;i<t.length;i++)if(t[i].identifier===e){s=i;break}return s}function i(e,i){for(var r={},l=[],o=0;o<e.length;o++){var a=e[o],h=i.base?a[0]+i.base:a[0],c=r[h]||0,d="".concat(h," ").concat(c);r[h]=c+1;var p=s(d),u={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var f=n(u,i);i.byIndex=o,t.splice(o,0,{identifier:d,updater:f,references:1})}l.push(d)}return l}function n(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,n){var r=i(e=e||[],n=n||{});return function(e){e=e||[];for(var l=0;l<r.length;l++){var o=s(r[l]);t[o].references--}for(var a=i(e,n),h=0;h<r.length;h++){var c=s(r[h]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=a}}},569:e=>{var t={};e.exports=function(e,s){var i=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},794:(e,t,s)=>{e.exports=s.p+"28a6df6fc2a815a964dd.svg"}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,s),r.exports}s.m=e,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),s.b=document.baseURI||self.location.href;var i={};(()=>{s.r(i),s.d(i,{default:()=>Ni,spreadsheet:()=>Mi});class e{constructor(e,t=""){"string"==typeof e?(this.el=document.createElement(e),this.el.className=t):this.el=e,this.data={}}data(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}on(e,t){const[s,...i]=e.split(".");let n=s;return"mousewheel"===n&&/Firefox/i.test(window.navigator.userAgent)&&(n="DOMMouseScroll"),this.el.addEventListener(n,(e=>{t(e);for(let t=0;t<i.length;t+=1){const s=i[t];if("left"===s&&0!==e.button)return;if("right"===s&&2!==e.button)return;"stop"===s&&e.stopPropagation()}})),this}offset(e){if(void 0!==e)return Object.keys(e).forEach((t=>{this.css(t,`${e[t]}px`)})),this;const{offsetTop:t,offsetLeft:s,offsetHeight:i,offsetWidth:n}=this.el;return{top:t,left:s,height:i,width:n}}scroll(e){const{el:t}=this;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}box(){return this.el.getBoundingClientRect()}parent(){return new e(this.el.parentNode)}children(...e){return 0===arguments.length?this.el.childNodes:(e.forEach((e=>this.child(e))),this)}removeChild(e){this.el.removeChild(e)}child(t){let s=t;return"string"==typeof t?s=document.createTextNode(t):t instanceof e&&(s=t.el),this.el.appendChild(s),this}contains(e){return this.el.contains(e)}className(e){return void 0!==e?(this.el.className=e,this):this.el.className}addClass(e){return this.el.classList.add(e),this}hasClass(e){return this.el.classList.contains(e)}removeClass(e){return this.el.classList.remove(e),this}toggle(e="active"){return this.toggleClass(e)}toggleClass(e){return this.el.classList.toggle(e)}active(e=!0,t="active"){return e?this.addClass(t):this.removeClass(t),this}checked(e=!0){return this.active(e,"checked"),this}disabled(e=!0){return e?this.addClass("disabled"):this.removeClass("disabled"),this}attr(e,t){if(void 0!==t)this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach((t=>{this.el.setAttribute(t,e[t])}))}return this}removeAttr(e){return this.el.removeAttribute(e),this}html(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}val(e){return void 0!==e?(this.el.value=e,this):this.el.value}focus(){this.el.focus()}cssRemoveKeys(...e){return e.forEach((e=>this.el.style.removeProperty(e))),this}css(e,t){return void 0===t&&"string"!=typeof e?(Object.keys(e).forEach((t=>{this.el.style[t]=e[t]})),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}computedStyle(){return window.getComputedStyle(this.el,null)}show(){return this.css("display","block"),this}hide(){return this.css("display","none"),this}}const t=(t,s="")=>new e(t,s),n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function r(e){let t="",s=e;for(;s>=n.length;)s/=n.length,s-=1,t+=n[parseInt(s,10)%n.length];return t+=n[e%n.length],t}function l(e){let t=0;for(let s=0;s<e.length-1;s+=1){const i=e.charCodeAt(s)-65,r=e.length-1-s;t+=n.length**r+n.length*i}return t+=e.charCodeAt(e.length-1)-65,t}function o(e){let t="",s="";for(let i=0;i<e.length;i+=1)e.charAt(i)>="0"&&e.charAt(i)<="9"?s+=e.charAt(i):t+=e.charAt(i);return[l(t),parseInt(s,10)-1]}function a(e,t){return`${r(e)}${t+1}`}function h(e,t,s,i=(()=>!0)){if(0===t&&0===s)return e;const[n,r]=o(e);return i(n,r)?a(n+t,r+s):e}class c{constructor(e,t,s,i,n=0,r=0){this.sri=e,this.sci=t,this.eri=s,this.eci=i,this.w=n,this.h=r}set(e,t,s,i){this.sri=e,this.sci=t,this.eri=s,this.eci=i}multiple(){return this.eri-this.sri>0||this.eci-this.sci>0}includes(...e){let[t,s]=[0,0];1===e.length?[s,t]=o(e[0]):2===e.length&&([t,s]=e);const{sri:i,sci:n,eri:r,eci:l}=this;return i<=t&&t<=r&&n<=s&&s<=l}each(e,t=(()=>!0)){const{sri:s,sci:i,eri:n,eci:r}=this;for(let l=s;l<=n;l+=1)if(t(l))for(let t=i;t<=r;t+=1)e(l,t)}contains(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}within(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}disjoint(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}intersects(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}union(e){const{sri:t,sci:s,eri:i,eci:n}=this;return new c(e.sri<t?e.sri:t,e.sci<s?e.sci:s,e.eri>i?e.eri:i,e.eci>n?e.eci:n)}difference(e){const t=[],s=(e,s,i,n)=>{t.push(new c(e,s,i,n))},{sri:i,sci:n,eri:r,eci:l}=this,o=e.sri-i,a=e.sci-n,h=r-e.eri,d=l-e.eci;return o>0?(s(i,n,e.sri-1,l),h>0?(s(e.eri+1,n,r,l),a>0&&s(e.sri,n,e.eri,e.sci-1),d>0&&s(e.sri,e.eci+1,e.eri,l)):(a>0&&s(e.sri,n,r,e.sci-1),d>0&&s(e.sri,e.eci+1,r,l))):h>0&&(s(e.eri+1,n,r,l),a>0&&s(i,n,e.eri,e.sci-1),d>0&&s(i,e.eci+1,e.eri,l)),a>0?(s(i,n,r,e.sci-1),d>0?(s(i,e.eri+1,r,l),o>0&&s(i,e.sci,e.sri-1,e.eci),h>0&&s(e.sri+1,e.sci,r,e.eci)):(o>0&&s(i,e.sci,e.sri-1,l),h>0&&s(e.sri+1,e.sci,r,l))):d>0&&(s(r,e.eci+1,r,l),o>0&&s(i,n,e.sri-1,e.eci),h>0&&s(e.eri+1,n,r,e.eci)),t}size(){return[this.eri-this.sri+1,this.eci-this.sci+1]}toString(){const{sri:e,sci:t,eri:s,eci:i}=this;let n=a(t,e);return this.multiple()&&(n=`${n}:${a(i,s)}`),n}clone(){const{sri:e,sci:t,eri:s,eci:i,w:n,h:r}=this;return new c(e,t,s,i,n,r)}equals(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}static valueOf(e){const t=e.split(":"),[s,i]=o(t[0]);let[n,r]=[i,s];return t.length>1&&([r,n]=o(t[1])),new c(i,s,n,r)}}class d{constructor(){this.range=new c(0,0,0,0),this.ri=0,this.ci=0}multiple(){return this.range.multiple()}setIndexes(e,t){this.ri=e,this.ci=t}size(){return this.range.size()}}class p{constructor(){this.x=0,this.y=0,this.ri=0,this.ci=0}}class u{constructor(){this.undoItems=[],this.redoItems=[]}add(e){this.undoItems.push(JSON.stringify(e)),this.redoItems=[]}canUndo(){return this.undoItems.length>0}canRedo(){return this.redoItems.length>0}undo(e,t){const{undoItems:s,redoItems:i}=this;this.canUndo()&&(i.push(JSON.stringify(e)),t(JSON.parse(s.pop())))}redo(e,t){const{undoItems:s,redoItems:i}=this;this.canRedo()&&(s.push(JSON.stringify(e)),t(JSON.parse(i.pop())))}}class f{constructor(){this.range=null,this.state="clear"}copy(e){return this.range=e,this.state="copy",this}cut(e){return this.range=e,this.state="cut",this}isCopy(){return"copy"===this.state}isCut(){return"cut"===this.state}isClear(){return"clear"===this.state}clear(){this.range=null,this.state="clear"}}class g{constructor(e,t,s){this.ci=e,this.operator=t,this.value=s}set(e,t){this.operator=e,this.value=t}includes(e){const{operator:t,value:s}=this;return"all"===t||"in"===t&&s.includes(e)}vlength(){const{operator:e,value:t}=this;return"in"===e?t.length:0}getData(){const{ci:e,operator:t,value:s}=this;return{ci:e,operator:t,value:s}}}class x{constructor(e,t){this.ci=e,this.order=t}asc(){return"asc"===this.order}desc(){return"desc"===this.order}}class m{constructor(){this.ref=null,this.filters=[],this.sort=null}setData({ref:e,filters:t,sort:s}){null!=e&&(this.ref=e,this.filters=t.map((e=>new g(e.ci,e.operator,e.value))),s&&(this.sort=new x(s.ci,s.order)))}getData(){if(this.active()){const{ref:e,filters:t,sort:s}=this;return{ref:e,filters:t.map((e=>e.getData())),sort:s}}return{}}addFilter(e,t,s){const i=this.getFilter(e);null==i?this.filters.push(new g(e,t,s)):i.set(t,s)}setSort(e,t){this.sort=t?new x(e,t):null}includes(e,t){return!!this.active()&&this.hrange().includes(e,t)}getSort(e){const{sort:t}=this;return t&&t.ci===e?t:null}getFilter(e){const{filters:t}=this;for(let s=0;s<t.length;s+=1)if(t[s].ci===e)return t[s];return null}filteredRows(e){const t=new Set,s=new Set;if(this.active()){const{sri:i,eri:n}=this.range(),{filters:r}=this;for(let l=i+1;l<=n;l+=1)for(let i=0;i<r.length;i+=1){const n=r[i],o=e(l,n.ci),a=o?o.text:"";if(!n.includes(a)){t.add(l);break}s.add(l)}}return{rset:t,fset:s}}items(e,t){const s={};if(this.active()){const{sri:i,eri:n}=this.range();for(let r=i+1;r<=n;r+=1){const i=t(r,e);if(null===i||/^\s*$/.test(i.text))s[""]=(s[""]||0)+1;else{const e=i.text,t=(s[e]||0)+1;s[e]=t}}}return s}range(){return c.valueOf(this.ref)}hrange(){const e=this.range();return e.eri=e.sri,e}clear(){this.ref=null,this.filters=[],this.sort=null}active(){return null!==this.ref}}class b{constructor(e=[]){this._=e}forEach(e){this._.forEach(e)}deleteWithin(e){this._=this._.filter((t=>!t.within(e)))}getFirstIncludes(e,t){for(let s=0;s<this._.length;s+=1){const i=this._[s];if(i.includes(e,t))return i}return null}filterIntersects(e){return new b(this._.filter((t=>t.intersects(e))))}intersects(e){for(let t=0;t<this._.length;t+=1)if(this._[t].intersects(e))return!0;return!1}union(e){let t=e;return this._.forEach((e=>{e.intersects(t)&&(t=e.union(t))})),t}add(e){this.deleteWithin(e),this._.push(e)}shift(e,t,s,i){this._.forEach((n=>{const{sri:r,sci:l,eri:o,eci:a}=n,h=n;"row"===e?r>=t?(h.sri+=s,h.eri+=s):r<t&&t<=o&&(h.eri+=s,i(r,l,s,0)):"column"===e&&(l>=t?(h.sci+=s,h.eci+=s):l<t&&t<=a&&(h.eci+=s,i(r,l,0,s)))}))}move(e,t,s){this._.forEach((i=>{const n=i;n.within(e)&&(n.eri+=t,n.sri+=t,n.sci+=s,n.eci+=s)}))}setData(e){return this._=e.map((e=>c.valueOf(e))),this}getData(){return this._.map((e=>e.toString()))}}const w=(e={},...t)=>(t.forEach((t=>{Object.keys(t).forEach((s=>{const i=t[s];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[s]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[s]=e[s]||{},w(e[s],i)):e[s]=i}))})),e);function v(e){const t=`${e}`;let s=0,i=!1;for(let e=0;e<t.length;e+=1)!0===i&&(s+=1),"."===t.charAt(e)&&(i=!0);return s}function y(e,t,s){if(Number.isNaN(t)||Number.isNaN(s))return t+e+s;const i=v(t),n=v(s),r=Number(t),l=Number(s);let o=0;if("-"===e)o=r-l;else if("+"===e)o=r+l;else if("*"===e)o=r*l;else if("/"===e)return o=r/l,v(o)>5?o.toFixed(2):o;return o.toFixed(Math.max(i,n))}const k=function(e){return JSON.parse(JSON.stringify(e))},C=(...e)=>w({},...e),E=function e(t,s){const i=Object.keys(t);if(i.length!==Object.keys(s).length)return!1;for(let n=0;n<i.length;n+=1){const r=i[n],l=t[r],o=s[r];if(void 0===o)return!1;if("string"==typeof l||"number"==typeof l||"boolean"==typeof l){if(l!==o)return!1}else if(Array.isArray(l)){if(l.length!==o.length)return!1;for(let t=0;t<l.length;t+=1)if(!e(l[t],o[t]))return!1}else if("function"!=typeof l&&!Array.isArray(l)&&l instanceof Object&&!e(l,o))return!1}return!0},S=function(e,t){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s+=1)if(e[s]!==t[s])return!1;return!0},$=function(e,t,s){let i=0;for(let n=e;n<t;n+=1)i+=s(n);return i},z=function(e,t,s,i,n,r){let l=s,o=i,a=e;for(;a<t&&!(l>n);a+=1)o=r(a),l+=o;return[a,l-o,o]};class T{constructor({len:e,height:t}){this._={},this.len=e,this.height=t}getHeight(e){if(this.isHide(e))return 0;const t=this.get(e);return t&&t.height?t.height:this.height}setHeight(e,t){this.getOrNew(e).height=t}unhide(e){let t=e;for(;t>0&&(t-=1,this.isHide(t));)this.setHide(t,!1)}isHide(e){const t=this.get(e);return t&&t.hide}setHide(e,t){const s=this.getOrNew(e);!0===t?s.hide=!0:delete s.hide}setStyle(e,t){this.getOrNew(e).style=t}sumHeight(e,t,s){return $(e,t,(e=>s&&s.has(e)?0:this.getHeight(e)))}totalHeight(){return this.sumHeight(0,this.len)}get(e){return this._[e]}getOrNew(e){return this._[e]=this._[e]||{cells:{}},this._[e]}getCell(e,t){const s=this.get(e);return void 0!==s&&void 0!==s.cells&&void 0!==s.cells[t]?s.cells[t]:null}getCellMerge(e,t){const s=this.getCell(e,t);return s&&s.merge?s.merge:[0,0]}getCellOrNew(e,t){const s=this.getOrNew(e);return s.cells[t]=s.cells[t]||{},s.cells[t]}setCell(e,t,s,i="all"){const n=this.getOrNew(e);"all"===i?n.cells[t]=s:"text"===i?(n.cells[t]=n.cells[t]||{},n.cells[t].text=s.text):"format"===i&&(n.cells[t]=n.cells[t]||{},n.cells[t].style=s.style,s.merge&&(n.cells[t].merge=s.merge))}setCellText(e,t,s){const i=this.getCellOrNew(e,t);!1!==i.editable&&(i.text=s)}copyPaste(e,t,s,i=!1,n=(()=>{})){const{sri:r,sci:l,eri:o,eci:a}=e,c=t.sri,d=t.sci,p=t.eri,u=t.eci,[f,g]=e.size(),[x,m]=t.size();let b=!0,w=0;(p<r||u<l)&&(b=!1,w=p<r?x:m);for(let e=r;e<=o;e+=1)if(this._[e])for(let t=l;t<=a;t+=1)if(this._[e].cells&&this._[e].cells[t])for(let x=c;x<=p;x+=f)for(let m=d;m<=u;m+=g){const v=x+(e-r),y=m+(t-l),C=k(this._[e].cells[t]);if(i&&C&&C.text&&C.text.length>0){const{text:e}=C;let t=m-d+(x-c)+2;if(b||(t-=w+1),"="===e[0])C.text=e.replace(/[a-zA-Z]{1,3}\d+/g,(e=>{let[s,i]=[0,0];return r===c?s=t-1:i=t-1,/^\d+$/.test(e)?e:h(e,s,i)}));else if(f<=1&&g>1&&(c>o||p<r)||g<=1&&f>1&&(d>a||u<l)||f<=1&&g<=1){const s=/[\\.\d]+$/.exec(e);if(null!==s){const i=Number(s[0])+t-1;C.text=e.substring(0,s.index)+i}}}this.setCell(v,y,C,s),n(v,y,C)}}cutPaste(e,t){const s={};this.each((i=>{this.eachCells(i,(n=>{let r=parseInt(i,10),l=parseInt(n,10);e.includes(i,n)&&(r=t.sri+(r-e.sri),l=t.sci+(l-e.sci)),s[r]=s[r]||{cells:{}},s[r].cells[l]=this._[i].cells[n]}))})),this._=s}paste(e,t){if(e.length<=0)return;const{sri:s,sci:i}=t;e.forEach(((e,t)=>{const n=s+t;e.forEach(((e,t)=>{const s=i+t;this.setCellText(n,s,e)}))}))}insert(e,t=1){const s={};this.each(((i,n)=>{let r=parseInt(i,10);r>=e&&(r+=t,this.eachCells(i,((s,i)=>{i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(s=>h(s,0,t,((t,s)=>s>=e)))))}))),s[r]=n})),this._=s,this.len+=t}delete(e,t){const s=t-e+1,i={};this.each(((n,r)=>{const l=parseInt(n,10);l<e?i[l]=r:n>t&&(i[l-s]=r,this.eachCells(n,((e,i)=>{i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(e=>h(e,0,-s,((e,s)=>s>t)))))})))})),this._=i,this.len-=s}insertColumn(e,t=1){this.each(((s,i)=>{const n={};this.eachCells(s,((s,i)=>{let r=parseInt(s,10);r>=e&&(r+=t,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(s=>h(s,t,0,(t=>t>=e)))))),n[r]=i})),i.cells=n}))}deleteColumn(e,t){const s=t-e+1;this.each(((i,n)=>{const r={};this.eachCells(i,((i,n)=>{const l=parseInt(i,10);l<e?r[l]=n:l>t&&(r[l-s]=n,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(e=>h(e,-s,0,(e=>e>t))))))})),n.cells=r}))}deleteCells(e,t="all"){e.each(((e,s)=>{this.deleteCell(e,s,t)}))}deleteCell(e,t,s="all"){const i=this.get(e);if(null!==i){const n=this.getCell(e,t);null!==n&&!1!==n.editable&&("all"===s?delete i.cells[t]:"text"===s?(n.text&&delete n.text,n.value&&delete n.value):"format"===s?(void 0!==n.style&&delete n.style,n.merge&&delete n.merge):"merge"===s&&n.merge&&delete n.merge)}}maxCell(){const e=Object.keys(this._),t=e[e.length-1],s=this._[t];if(s){const{cells:e}=s,i=Object.keys(e),n=i[i.length-1];return[parseInt(t,10),parseInt(n,10)]}return[0,0]}each(e){Object.entries(this._).forEach((([t,s])=>{e(t,s)}))}eachCells(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach((([e,s])=>{t(e,s)}))}setData(e){e.len&&(this.len=e.len,delete e.len),this._=e}getData(){const{len:e}=this;return Object.assign({len:e},this._)}}class D{constructor({len:e,width:t,indexWidth:s,minWidth:i}){this._={},this.len=e,this.width=t,this.indexWidth=s,this.minWidth=i}setData(e){e.len&&(this.len=e.len,delete e.len),this._=e}getData(){const{len:e}=this;return Object.assign({len:e},this._)}getWidth(e){if(this.isHide(e))return 0;const t=this._[e];return t&&t.width?t.width:this.width}getOrNew(e){return this._[e]=this._[e]||{},this._[e]}setWidth(e,t){this.getOrNew(e).width=t}unhide(e){let t=e;for(;t>0&&(t-=1,this.isHide(t));)this.setHide(t,!1)}isHide(e){const t=this._[e];return t&&t.hide}setHide(e,t){const s=this.getOrNew(e);!0===t?s.hide=!0:delete s.hide}setStyle(e,t){this.getOrNew(e).style=t}sumWidth(e,t){return $(e,t,(e=>this.getWidth(e)))}totalWidth(){return this.sumWidth(0,this.len)}}let O=["en"];const R={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function A(e,t){if(t)for(const s of O){if(!t[s])break;let i=t[s];const n=e.match(/(?:\\.|[^.])+/g);for(let e=0;e<n.length;e+=1){const t=i[n[e]];if(!t)break;if(e===n.length-1)return t;i=t}}}function I(e){let t=A(e,R);return!t&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(t=A(e,window.x_spreadsheet.$messages)),t||""}function H(e){return()=>I(e)}function M(e,t,s=!1){s?O=[e]:O.unshift(e),t&&(R[e]=t)}const N={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function F(e,t,...s){let i="";return e||(i=I(`validation.${t}`,...s)),[e,i]}class W{constructor(e,t,s,i){this.required=t,this.value=s,this.type=e,this.operator=i,this.message=""}parseValue(e){const{type:t}=this;return"date"===t?new Date(e):"number"===t?Number(e):e}equals(e){let t=this.type===e.type&&this.required===e.required&&this.operator===e.operator;return t&&(t=Array.isArray(this.value)?S(this.value,e.value):this.value===e.value),t}values(){return this.value.split(",")}validate(e){const{required:t,operator:s,value:i,type:n}=this;if(t&&/^\s*$/.test(e))return F(!1,"required");if(/^\s*$/.test(e))return[!0];if(N[n]&&!N[n].test(e))return F(!1,"notMatch");if("list"===n)return F(this.values().includes(e),"notIn");if(s){const t=this.parseValue(e);if("be"===s){const[e,s]=i;return F(t>=this.parseValue(e)&&t<=this.parseValue(s),"between",e,s)}if("nbe"===s){const[e,s]=i;return F(t<this.parseValue(e)||t>this.parseValue(s),"notBetween",e,s)}if("eq"===s)return F(t===this.parseValue(i),"equal",i);if("neq"===s)return F(t!==this.parseValue(i),"notEqual",i);if("lt"===s)return F(t<this.parseValue(i),"lessThan",i);if("lte"===s)return F(t<=this.parseValue(i),"lessThanEqual",i);if("gt"===s)return F(t>this.parseValue(i),"greaterThan",i);if("gte"===s)return F(t>=this.parseValue(i),"greaterThanEqual",i)}return[!0]}}class V{constructor(e,t,s){this.refs=t,this.mode=e,this.validator=s}includes(e,t){const{refs:s}=this;for(let i=0;i<s.length;i+=1)if(c.valueOf(s[i]).includes(e,t))return!0;return!1}addRef(e){this.remove(c.valueOf(e)),this.refs.push(e)}remove(e){const t=[];this.refs.forEach((s=>{const i=c.valueOf(s);i.intersects(e)?i.difference(e).forEach((e=>t.push(e.toString()))):t.push(s)})),this.refs=t}getData(){const{refs:e,mode:t,validator:s}=this,{type:i,required:n,operator:r,value:l}=s;return{refs:e,mode:t,type:i,required:n,operator:r,value:l}}static valueOf({refs:e,mode:t,type:s,required:i,operator:n,value:r}){return new V(t,e,new W(s,i,r,n))}}class _{constructor(){this._=[],this.errors=new Map}getError(e,t){return this.errors.get(`${e}_${t}`)}validate(e,t,s){const i=this.get(e,t),n=`${e}_${t}`,{errors:r}=this;if(null!==i){const[e,t]=i.validator.validate(s);e?r.delete(n):r.set(n,t)}else r.delete(n);return!0}add(e,t,{type:s,required:i,value:n,operator:r}){const l=new W(s,i,n,r),o=this.getByValidator(l);null!==o?o.addRef(t):this._.push(new V(e,[t],l))}getByValidator(e){for(let t=0;t<this._.length;t+=1){const s=this._[t];if(s.validator.equals(e))return s}return null}get(e,t){for(let s=0;s<this._.length;s+=1){const i=this._[s];if(i.includes(e,t))return i}return null}remove(e){this.each((t=>{t.remove(e)}))}each(e){this._.forEach((t=>e(t)))}getData(){return this._.filter((e=>e.refs.length>0)).map((e=>e.getData()))}setData(e){this._=e.map((e=>V.valueOf(e)))}}const P={mode:"edit",view:{height:()=>document.documentElement.clientHeight,width:()=>document.documentElement.clientWidth},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}},q=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function L(e,t,s=(()=>{})){const{merges:i}=this,n=t.clone(),[r,l]=e.size(),[o,a]=t.size();return r>o&&(n.eri=t.sri+r-1),l>a&&(n.eci=t.sci+l-1),!i.intersects(n)||(s(I("error.pasteForMergedCell")),!1)}function B(e,t,s,i=!1){const{rows:n,merges:r}=this;"all"!==s&&"format"!==s||(n.deleteCells(t,s),r.deleteWithin(t)),n.copyPaste(e,t,s,i,((e,t,s)=>{if(s&&s.merge){const[i,n]=s.merge;if(i<=0&&n<=0)return;r.add(new c(e,t,e+i,t+n))}}))}function j(e,t){const{clipboard:s,rows:i,merges:n}=this;i.cutPaste(e,t),n.move(e,t.sri-e.sri,t.sci-e.sci),s.clear()}function U(e,t,s){const{styles:i,rows:n}=this,r=n.getCellOrNew(e,t);let l={};void 0!==r.style&&(l=k(i[r.style])),l=C(l,{border:s}),r.style=this.addStyle(l)}function Y({mode:e,style:t,color:s}){const{styles:i,selector:n,rows:r}=this,{sri:l,sci:o,eri:a,eci:h}=n.range,c=!this.isSignleSelected();if(c||"inside"!==e&&"horizontal"!==e&&"vertical"!==e)if("outside"!==e||c){if("none"===e)n.range.each(((e,t)=>{const s=r.getCell(e,t);if(s&&void 0!==s.style){const e=k(i[s.style]);delete e.border,s.style=this.addStyle(e)}}));else if("all"===e||"inside"===e||"outside"===e||"horizontal"===e||"vertical"===e){const i=[];for(let n=l;n<=a;n+=1)for(let d=o;d<=h;d+=1){const p=[];for(let e=0;e<i.length;e+=1){const[t,s,r,l]=i[e];if(n===t+r+1&&p.push(e),t<=n&&n<=t+r&&d===s){d+=l+1;break}}if(p.forEach((e=>i.splice(e,1))),d>h)break;const u=r.getCell(n,d);let[f,g]=[0,0];u&&u.merge&&([f,g]=u.merge,i.push([n,d,f,g]));const x=f>0&&n+f===a,m=g>0&&d+g===h;let b={};"all"===e?b={bottom:[t,s],top:[t,s],left:[t,s],right:[t,s]}:"inside"===e?(!m&&d<h&&(b.right=[t,s]),!x&&n<a&&(b.bottom=[t,s])):"horizontal"===e?!x&&n<a&&(b.bottom=[t,s]):"vertical"===e?!m&&d<h&&(b.right=[t,s]):"outside"===e&&c&&(l===n&&(b.top=[t,s]),(x||a===n)&&(b.bottom=[t,s]),o===d&&(b.left=[t,s]),(m||h===d)&&(b.right=[t,s])),Object.keys(b).length>0&&U.call(this,n,d,b),d+=g}}else if("top"===e||"bottom"===e)for(let i=o;i<=h;i+=1)"top"===e&&(U.call(this,l,i,{top:[t,s]}),i+=r.getCellMerge(l,i)[1]),"bottom"===e&&(U.call(this,a,i,{bottom:[t,s]}),i+=r.getCellMerge(a,i)[1]);else if("left"===e||"right"===e)for(let i=l;i<=a;i+=1)"left"===e&&(U.call(this,i,o,{left:[t,s]}),i+=r.getCellMerge(i,o)[0]),"right"===e&&(U.call(this,i,h,{right:[t,s]}),i+=r.getCellMerge(i,h)[0])}else U.call(this,l,o,{top:[t,s],bottom:[t,s],left:[t,s],right:[t,s]})}function X(e,t){const{rows:s}=this,i=this.freezeTotalHeight();let n=s.height;i+s.height<e&&(n-=t);const r=this.exceptRowSet;let l=0,o=n,{height:a}=s;for(;l<s.len&&!(o>e);l+=1)r.has(l)||(a=s.getHeight(l),o+=a);return o-=a,o<=0?{ri:-1,top:0,height:a}:{ri:l-1,top:o,height:a}}function Z(e,t){const{cols:s}=this,i=this.freezeTotalWidth();let n=s.indexWidth;i+s.indexWidth<e&&(n-=t);const[r,l,o]=z(0,s.len,n,s.indexWidth,e,(e=>s.getWidth(e)));return l<=0?{ci:-1,left:0,width:s.indexWidth}:{ci:r-1,left:l,width:o}}class J{constructor(e,t){this.settings=C(P,t||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new b,this.rows=new T(this.settings.row),this.cols=new D(this.settings.col),this.validations=new _,this.hyperlinks={},this.comments={},this.selector=new d,this.scroll=new p,this.history=new u,this.clipboard=new f,this.autoFilter=new m,this.change=()=>{},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}addValidation(e,t,s){this.changeData((()=>{this.validations.add(e,t,s)}))}removeValidation(){const{range:e}=this.selector;this.changeData((()=>{this.validations.remove(e)}))}getSelectedValidator(){const{ri:e,ci:t}=this.selector,s=this.validations.get(e,t);return s?s.validator:null}getSelectedValidation(){const{ri:e,ci:t,range:s}=this.selector,i=this.validations.get(e,t),n={ref:s.toString()};return null!==i&&(n.mode=i.mode,n.validator=i.validator),n}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}undo(){this.history.undo(this.getData(),(e=>{this.setData(e)}))}redo(){this.history.redo(this.getData(),(e=>{this.setData(e)}))}copy(){this.clipboard.copy(this.selector.range)}copyToSystemClipboard(){if(void 0===navigator.clipboard)return;let e="";const t=this.rows.getData();for(let s=this.selector.range.sri;s<=this.selector.range.eri;s+=1){if(q(t,s)){for(let i=this.selector.range.sci;i<=this.selector.range.eci;i+=1)if(i>this.selector.range.sci&&(e+="\t"),q(t[s].cells,i)){const n=String(t[s].cells[i].text);-1===n.indexOf("\n")&&-1===n.indexOf("\t")&&-1===n.indexOf('"')?e+=n:e+=`"${n}"`}}else for(let t=this.selector.range.sci;t<=this.selector.range.eci;t+=1)e+="\t";e+="\n"}navigator.clipboard.writeText(e).then((()=>{}),(t=>{console.log("text copy to the system clipboard error  ",e,t)}))}cut(){this.clipboard.cut(this.selector.range)}paste(e="all",t=(()=>{})){const{clipboard:s,selector:i}=this;return!s.isClear()&&!!L.call(this,s.range,i.range,t)&&(this.changeData((()=>{s.isCopy()?B.call(this,s.range,i.range,e):s.isCut()&&j.call(this,s.range,i.range)})),!0)}pasteFromText(e){const t=e.split("\r\n").map((e=>e.replace(/"/g,"").split("\t")));t.length>0&&(t.length-=1);const{rows:s,selector:i}=this;this.changeData((()=>{s.paste(t,i.range)}))}autofill(e,t,s=(()=>{})){const i=this.selector.range;return!!L.call(this,i,e,s)&&(this.changeData((()=>{B.call(this,i,e,t,!0)})),!0)}clearClipboard(){this.clipboard.clear()}calSelectedRangeByEnd(e,t){const{selector:s,rows:i,cols:n,merges:r}=this;let{sri:l,sci:o,eri:a,eci:h}=s.range;const d=s.ri,p=s.ci;let[u,f]=[e,t];return e<0&&(u=i.len-1),t<0&&(f=n.len-1),[l,a]=u>d?[d,u]:[u,d],[o,h]=f>p?[p,f]:[f,p],s.range=r.union(new c(l,o,a,h)),s.range=r.union(s.range),s.range}calSelectedRangeByStart(e,t){const{selector:s,rows:i,cols:n,merges:r}=this;let l=r.getFirstIncludes(e,t);return null===l&&(l=new c(e,t,e,t),-1===e&&(l.sri=0,l.eri=i.len-1),-1===t&&(l.sci=0,l.eci=n.len-1)),s.range=l,l}setSelectedCellAttr(e,t){this.changeData((()=>{const{selector:s,styles:i,rows:n}=this;if("merge"===e)t?this.merge():this.unmerge();else if("border"===e)Y.call(this,t);else if("formula"===e){const{ri:e,ci:i,range:r}=s;if(s.multiple()){const[i,l]=s.size(),{sri:o,sci:h,eri:c,eci:d}=r;if(i>1)for(let e=h;e<=d;e+=1)n.getCellOrNew(c+1,e).text=`=${t}(${a(e,o)}:${a(e,c)})`;else l>1&&(n.getCellOrNew(e,d+1).text=`=${t}(${a(h,e)}:${a(d,e)})`)}else n.getCellOrNew(e,i).text=`=${t}()`}else s.range.each(((s,r)=>{const l=n.getCellOrNew(s,r);let o={};if(void 0!==l.style&&(o=k(i[l.style])),"format"===e)o.format=t,l.style=this.addStyle(o);else if("font-bold"===e||"font-italic"===e||"font-name"===e||"font-size"===e){const s={};s[e.split("-")[1]]=t,o.font=Object.assign(o.font||{},s),l.style=this.addStyle(o)}else"strike"===e||"textwrap"===e||"underline"===e||"align"===e||"valign"===e||"color"===e||"bgcolor"===e?(o[e]=t,l.style=this.addStyle(o)):l[e]=t}))}))}setSelectedCellText(e,t="input"){const{autoFilter:s,selector:i,rows:n}=this,{ri:r,ci:l}=i;let o=r;this.unsortedRowMap.has(r)&&(o=this.unsortedRowMap.get(r));const a=n.getCell(o,l),h=a?a.text:"";if(this.setCellText(o,l,e,t),s.active()){const t=s.getFilter(l);if(t){const s=t.value.findIndex((e=>e===h));s>=0&&t.value.splice(s,1,e)}}}getSelectedCell(){const{ri:e,ci:t}=this.selector;let s=e;return this.unsortedRowMap.has(e)&&(s=this.unsortedRowMap.get(e)),this.rows.getCell(s,t)}xyInSelectedRect(e,t){const{left:s,top:i,width:n,height:r}=this.getSelectedRect(),l=e-this.cols.indexWidth,o=t-this.rows.height;return l>s&&l<s+n&&o>i&&o<i+r}getSelectedRect(){return this.getRect(this.selector.range)}getClipboardRect(){const{clipboard:e}=this;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}getRect(e){const{scroll:t,rows:s,cols:i,exceptRowSet:n}=this,{sri:r,sci:l,eri:o,eci:a}=e;if(r<0&&l<0)return{left:0,l:0,top:0,t:0,scroll:t};const h=i.sumWidth(0,l),c=s.sumHeight(0,r,n),d=s.sumHeight(r,o+1,n),p=i.sumWidth(l,a+1);let u=h-t.x,f=c-t.y;const g=this.freezeTotalHeight(),x=this.freezeTotalWidth();return x>0&&x>h&&(u=h),g>0&&g>c&&(f=c),{l:h,t:c,left:u,top:f,height:d,width:p,scroll:t}}getCellRectByXY(e,t){const{scroll:s,merges:i,rows:n,cols:r}=this;let{ri:l,top:o,height:a}=X.call(this,t,s.y),{ci:h,left:c,width:d}=Z.call(this,e,s.x);if(-1===h&&(d=r.totalWidth()),-1===l&&(a=n.totalHeight()),l>=0||h>=0){const e=i.getFirstIncludes(l,h);e&&(l=e.sri,h=e.sci,({left:c,top:o,width:d,height:a}=this.cellRect(l,h)))}return{ri:l,ci:h,left:c,top:o,width:d,height:a}}isSignleSelected(){const{sri:e,sci:t,eri:s,eci:i}=this.selector.range,n=this.getCell(e,t);if(n&&n.merge){const[r,l]=n.merge;if(e+r===s&&t+l===i)return!0}return!this.selector.multiple()}canUnmerge(){const{sri:e,sci:t,eri:s,eci:i}=this.selector.range,n=this.getCell(e,t);if(n&&n.merge){const[r,l]=n.merge;if(e+r===s&&t+l===i)return!0}return!1}merge(){const{selector:e,rows:t}=this;if(this.isSignleSelected())return;const[s,i]=e.size();if(s>1||i>1){const{sri:n,sci:r}=e.range;this.changeData((()=>{const l=t.getCellOrNew(n,r);l.merge=[s-1,i-1],this.merges.add(e.range),this.rows.deleteCells(e.range),this.rows.setCell(n,r,l)}))}}unmerge(){const{selector:e}=this;if(!this.isSignleSelected())return;const{sri:t,sci:s}=e.range;this.changeData((()=>{this.rows.deleteCell(t,s,"merge"),this.merges.deleteWithin(e.range)}))}canAutofilter(){return!this.autoFilter.active()}autofilter(){const{autoFilter:e,selector:t}=this;this.changeData((()=>{e.active()?(e.clear(),this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map):e.ref=t.range.toString()}))}setAutoFilter(e,t,s,i){const{autoFilter:n}=this;n.addFilter(e,s,i),n.setSort(e,t),this.resetAutoFilter()}resetAutoFilter(){const{autoFilter:e,rows:t}=this;if(!e.active())return;const{sort:s}=e,{rset:i,fset:n}=e.filteredRows(((e,s)=>t.getCell(e,s))),r=Array.from(n),l=Array.from(n);s&&r.sort(((e,t)=>"asc"===s.order?e-t:"desc"===s.order?t-e:0)),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,r.forEach(((e,t)=>{this.sortedRowMap.set(l[t],e),this.unsortedRowMap.set(e,l[t])}))}deleteCell(e="all"){const{selector:t}=this;this.changeData((()=>{this.rows.deleteCells(t.range,e),"all"!==e&&"format"!==e||this.merges.deleteWithin(t.range)}))}insert(e,t=1){this.changeData((()=>{const{sri:s,sci:i}=this.selector.range,{rows:n,merges:r,cols:l}=this;let o=s;"row"===e?n.insert(s,t):"column"===e&&(n.insertColumn(i,t),o=i,l.len+=1),r.shift(e,o,t,((e,t,s,i)=>{const r=n.getCell(e,t);r.merge[0]+=s,r.merge[1]+=i}))}))}delete(e){this.changeData((()=>{const{rows:t,merges:s,selector:i,cols:n}=this,{range:r}=i,{sri:l,sci:o,eri:a,eci:h}=i.range,[c,d]=i.range.size();let p=l,u=c;"row"===e?t.delete(l,a):"column"===e&&(t.deleteColumn(o,h),p=r.sci,u=d,n.len-=1),s.shift(e,p,-u,((e,s,i,n)=>{const r=t.getCell(e,s);r.merge[0]+=i,r.merge[1]+=n,0===r.merge[0]&&0===r.merge[1]&&delete r.merge}))}))}scrollx(e,t){const{scroll:s,freeze:i,cols:n}=this,[,r]=i,[l,o,a]=z(r,n.len,0,0,e,(e=>n.getWidth(e)));let h=o;e>0&&(h+=a),s.x!==h&&(s.ci=e>0?l:0,s.x=h,t())}scrolly(e,t){const{scroll:s,freeze:i,rows:n}=this,[r]=i,[l,o,a]=z(r,n.len,0,0,e,(e=>n.getHeight(e)));let h=o;e>0&&(h+=a),s.y!==h&&(s.ri=e>0?l:0,s.y=h,t())}cellRect(e,t){const{rows:s,cols:i}=this,n=i.sumWidth(0,t),r=s.sumHeight(0,e),l=s.getCell(e,t);let o=i.getWidth(t),a=s.getHeight(e);if(null!==l&&l.merge){const[n,r]=l.merge;if(n>0)for(let t=1;t<=n;t+=1)a+=s.getHeight(e+t);if(r>0)for(let e=1;e<=r;e+=1)o+=i.getWidth(t+e)}return{left:n,top:r,width:o,height:a,cell:l}}getCell(e,t){return this.rows.getCell(e,t)}getCellTextOrDefault(e,t){const s=this.getCell(e,t);return s&&s.text?s.text:""}getCellStyle(e,t){const s=this.getCell(e,t);return s&&void 0!==s.style?this.styles[s.style]:null}getCellStyleOrDefault(e,t){const{styles:s,rows:i}=this,n=i.getCell(e,t),r=n&&void 0!==n.style?s[n.style]:{};return C(this.defaultStyle(),r)}getSelectedCellStyle(){const{ri:e,ci:t}=this.selector;return this.getCellStyleOrDefault(e,t)}setCellText(e,t,s,i){const{rows:n,history:r,validations:l}=this;"finished"===i?(n.setCellText(e,t,""),r.add(this.getData()),n.setCellText(e,t,s)):(n.setCellText(e,t,s),this.change(this.getData())),l.validate(e,t,s)}freezeIsActive(){const[e,t]=this.freeze;return e>0||t>0}setFreeze(e,t){this.changeData((()=>{this.freeze=[e,t]}))}freezeTotalWidth(){return this.cols.sumWidth(0,this.freeze[1])}freezeTotalHeight(){return this.rows.sumHeight(0,this.freeze[0])}setRowHeight(e,t){this.changeData((()=>{this.rows.setHeight(e,t)}))}setColWidth(e,t){this.changeData((()=>{this.cols.setWidth(e,t)}))}viewHeight(){const{view:e,showToolbar:t,showBottomBar:s}=this.settings;let i=e.height();return s&&(i-=41),t&&(i-=41),i}viewWidth(){return this.settings.view.width()}freezeViewRange(){const[e,t]=this.freeze;return new c(0,0,e-1,t-1,this.freezeTotalWidth(),this.freezeTotalHeight())}contentRange(){const{rows:e,cols:t}=this,[s,i]=e.maxCell(),n=e.sumHeight(0,s+1),r=t.sumWidth(0,i+1);return new c(0,0,s,i,r,n)}exceptRowTotalHeight(e,t){const{exceptRowSet:s,rows:i}=this,n=Array.from(s);let r=0;return n.forEach((s=>{if(s<e||s>t){const e=i.getHeight(s);r+=e}})),r}viewRange(){const{scroll:e,rows:t,cols:s,freeze:i,exceptRowSet:n}=this;let{ri:r,ci:l}=e;r<=0&&([r]=i),l<=0&&([,l]=i);let[o,a]=[0,0],[h,d]=[t.len,s.len];for(let e=r;e<t.len&&(n.has(e)||(a+=t.getHeight(e),h=e),!(a>this.viewHeight()));e+=1);for(let e=l;e<s.len&&(o+=s.getWidth(e),d=e,!(o>this.viewWidth()));e+=1);return new c(r,l,h,d,o,a)}eachMergesInView(e,t){this.merges.filterIntersects(e).forEach((e=>t(e)))}hideRowsOrCols(){const{rows:e,cols:t,selector:s}=this,[i,n]=s.size(),{sri:r,sci:l,eri:o,eci:a}=s.range;if(i===e.len)for(let e=l;e<=a;e+=1)t.setHide(e,!0);else if(n===t.len)for(let t=r;t<=o;t+=1)e.setHide(t,!0)}unhideRowsOrCols(e,t){this[`${e}s`].unhide(t)}rowEach(e,t,s){let i=0;const{rows:n}=this,r=this.exceptRowSet,l=[...r];let o=0;for(let t=0;t<l.length;t+=1)l[t]<e&&(o+=1);for(let l=e+o;l<=t+o;l+=1)if(r.has(l))o+=1;else{const e=n.getHeight(l);if(e>0&&(s(l,i,e),i+=e,i>this.viewHeight()))break}}colEach(e,t,s){let i=0;const{cols:n}=this;for(let r=e;r<=t;r+=1){const e=n.getWidth(r);if(e>0&&(s(r,i,e),i+=e,i>this.viewWidth()))break}}defaultStyle(){return this.settings.style}addStyle(e){const{styles:t}=this;for(let s=0;s<t.length;s+=1){const i=t[s];if(E(i,e))return s}return t.push(e),t.length-1}changeData(e){this.history.add(this.getData()),e(),this.change(this.getData())}setData(e){return Object.keys(e).forEach((t=>{if("merges"===t||"rows"===t||"cols"===t||"validations"===t)this[t].setData(e[t]);else if("freeze"===t){const[s,i]=o(e[t]);this.freeze=[i,s]}else"autofilter"===t?this.autoFilter.setData(e[t]):void 0!==e[t]&&(this[t]=e[t])})),this}getData(){const{name:e,freeze:t,styles:s,merges:i,rows:n,cols:r,validations:l,autoFilter:o}=this;return{name:e,freeze:a(t[1],t[0]),styles:s,merges:i.getData(),rows:n.getData(),cols:r.getData(),validations:l.getData(),autofilter:o.getData()}}}function K(e,t,s){e.addEventListener(t,s)}function G(e,t,s){e.removeEventListener(t,s)}function Q(e){e.xclickoutside&&(G(window.document.body,"click",e.xclickoutside),delete e.xclickoutside)}function ee(e,t){e.xclickoutside=s=>{2===s.detail||e.contains(s.target)||(t?t(e):(e.hide(),Q(e)))},K(window.document.body,"click",e.xclickoutside)}function te(e,t,s){K(e,"mousemove",t),e.xEvtUp=i=>{G(e,"mousemove",t),G(e,"mouseup",e.xEvtUp),s(i)},K(e,"mouseup",e.xEvtUp)}function se(e,t,s,i){let n="";Math.abs(e)>Math.abs(t)?(n=e>0?"right":"left",i(n,e,s)):(n=t>0?"down":"up",i(n,t,s))}const ie="x-spreadsheet";window.devicePixelRatio;class ne{constructor(e=!1,s){this.moving=!1,this.vertical=e,this.el=t("div",`${ie}-resizer ${e?"vertical":"horizontal"}`).children(this.unhideHoverEl=t("div",`${ie}-resizer-hover`).on("dblclick.stop",(e=>this.mousedblclickHandler(e))).css("position","absolute").hide(),this.hoverEl=t("div",`${ie}-resizer-hover`).on("mousedown.stop",(e=>this.mousedownHandler(e))),this.lineEl=t("div",`${ie}-resizer-line`).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=s,this.unhideFn=()=>{}}showUnhide(e){this.unhideIndex=e,this.unhideHoverEl.show()}hideUnhide(){this.unhideHoverEl.hide()}show(e,t){const{moving:s,vertical:i,hoverEl:n,lineEl:r,el:l,unhideHoverEl:o}=this;if(s)return;this.cRect=e;const{left:a,top:h,width:c,height:d}=e;l.offset({left:i?a+c-5:a,top:i?h:h+d-5}).show(),n.offset({width:i?5:c,height:i?d:5}),r.offset({width:i?0:t.width,height:i?t.height:0}),o.offset({left:i?5-c:a,top:i?h:5-d,width:i?5:c,height:i?d:5})}hide(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}mousedblclickHandler(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}mousedownHandler(e){let t=e;const{el:s,lineEl:i,cRect:n,vertical:r,minDistance:l}=this;let o=r?n.width:n.height;i.show(),te(window,(e=>{this.moving=!0,null!==t&&1===e.buttons&&(r?(o+=e.movementX,o>l&&s.css("left",`${n.left+o}px`)):(o+=e.movementY,o>l&&s.css("top",`${n.top+o}px`)),t=e)}),(()=>{t=null,i.hide(),this.moving=!1,this.hide(),this.finishedFn&&(o<l&&(o=l),this.finishedFn(n,o))}))}}class re{constructor(e){this.vertical=e,this.moveFn=null,this.el=t("div",`${ie}-scrollbar ${e?"vertical":"horizontal"}`).child(this.contentEl=t("div","")).on("mousemove.stop",(()=>{})).on("scroll.stop",(e=>{const{scrollTop:t,scrollLeft:s}=e.target;this.moveFn&&this.moveFn(this.vertical?t:s,e)}))}move(e){return this.el.scroll(e),this}scroll(){return this.el.scroll()}set(e,t){const s=e-1;if(t>s){const e=this.vertical?"height":"width";this.el.css(e,s-15+"px").show(),this.contentEl.css(this.vertical?"width":"height","1px").css(e,`${t}px`)}else this.el.hide();return this}}let le=10;class oe{constructor(e=!1){this.useHideInput=e,this.inputChange=()=>{},this.cornerEl=t("div",`${ie}-selector-corner`),this.areaEl=t("div",`${ie}-selector-area`).child(this.cornerEl).hide(),this.clipboardEl=t("div",`${ie}-selector-clipboard`).hide(),this.autofillEl=t("div",`${ie}-selector-autofill`).hide(),this.el=t("div",`${ie}-selector`).css("z-index",`${le}`).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),e&&(this.hideInput=t("input","").on("compositionend",(e=>{this.inputChange(e.target.value)})),this.el.child(this.hideInputDiv=t("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=t("div","hide-input").child(this.hideInput))),le+=1}setOffset(e){return this.el.offset(e).show(),this}hide(){return this.el.hide(),this}setAreaOffset(e){const{left:t,top:s,width:i,height:n}=e,r={width:i-3+.8,height:n-3+.8,left:t-.8,top:s-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.hideInput.val("").focus())}setClipboardOffset(e){const{left:t,top:s,width:i,height:n}=e;this.clipboardEl.offset({left:t,top:s,width:i-5,height:n-5})}showAutofill(e){const{left:t,top:s,width:i,height:n}=e;this.autofillEl.offset({width:i-3,height:n-3,left:t,top:s}).show()}hideAutofill(){this.autofillEl.hide()}showClipboard(){this.clipboardEl.show()}hideClipboard(){this.clipboardEl.hide()}}function ae(e){const{data:t}=this,{left:s,top:i,width:n,height:r,scroll:l,l:o,t:a}=e,h=t.freezeTotalWidth(),c=t.freezeTotalHeight();let d=s-h;h>o&&(d-=l.x);let p=i-c;return c>a&&(p-=l.y),{left:d,top:p,width:n,height:r}}function he(e){const{data:t}=this,{left:s,width:i,height:n,l:r,t:l,scroll:o}=e,a=t.freezeTotalWidth();let h=s-a;return a>r&&(h-=o.x),{left:h,top:l,width:i,height:n}}function ce(e){const{data:t}=this,{top:s,width:i,height:n,l:r,t:l,scroll:o}=e,a=t.freezeTotalHeight();let h=s-a;return a>l&&(h-=o.y),{left:r,top:h,width:i,height:n}}function de(e){const{br:t}=this;t.setAreaOffset(ae.call(this,e))}function pe(e){const{tl:t}=this;t.setAreaOffset(e)}function ue(e){const{t}=this;t.setAreaOffset(he.call(this,e))}function fe(e){const{l:t}=this;t.setAreaOffset(ce.call(this,e))}function ge(e){const{l:t}=this;t.setClipboardOffset(ce.call(this,e))}function xe(e){const{br:t}=this;t.setClipboardOffset(ae.call(this,e))}function me(e){const{tl:t}=this;t.setClipboardOffset(e)}function be(e){const{t}=this;t.setClipboardOffset(he.call(this,e))}function we(e){de.call(this,e),pe.call(this,e),ue.call(this,e),fe.call(this,e)}function ve(e){xe.call(this,e),me.call(this,e),be.call(this,e),ge.call(this,e)}class ye{constructor(e){this.inputChange=()=>{},this.data=e,this.br=new oe(!0),this.t=new oe,this.l=new oe,this.tl=new oe,this.br.inputChange=e=>{this.inputChange(e)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=t("div",`${ie}-selectors`).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,le+=1}resetData(e){this.data=e,this.range=e.selector.range,this.resetAreaOffset()}hide(){this.el.hide()}resetOffset(){const{data:e,tl:t,t:s,l:i,br:n}=this,r=e.freezeTotalHeight(),l=e.freezeTotalWidth();r>0||l>0?(t.setOffset({width:l,height:r}),s.setOffset({left:l,height:r}),i.setOffset({top:r,width:l}),n.setOffset({left:l,top:r})):(t.hide(),s.hide(),i.hide(),n.setOffset({left:0,top:0}))}resetAreaOffset(){const e=this.data.getSelectedRect(),t=this.data.getClipboardRect();we.call(this,e),ve.call(this,t),this.resetOffset()}resetBRTAreaOffset(){const e=this.data.getSelectedRect(),t=this.data.getClipboardRect();de.call(this,e),ue.call(this,e),xe.call(this,t),be.call(this,t),this.resetOffset()}resetBRLAreaOffset(){const e=this.data.getSelectedRect(),t=this.data.getClipboardRect();de.call(this,e),fe.call(this,e),xe.call(this,t),ge.call(this,t),this.resetOffset()}set(e,t,s=!0){const{data:i}=this,n=i.calSelectedRangeByStart(e,t),{sri:r,sci:l}=n;if(s){let[s,n]=[e,t];e<0&&(s=0),t<0&&(n=0),i.selector.setIndexes(s,n),this.indexes=[s,n]}this.moveIndexes=[r,l],this.range=n,this.resetAreaOffset(),this.el.show()}setEnd(e,t,s=!0){const{data:i,lastri:n,lastci:r}=this;if(s){if(e===n&&t===r)return;this.lastri=e,this.lastci=t}this.range=i.calSelectedRangeByEnd(e,t),we.call(this,this.data.getSelectedRect())}reset(){const{eri:e,eci:t}=this.data.selector.range;this.setEnd(e,t)}showAutofill(e,t){if(-1===e&&-1===t)return;const{sri:s,sci:i,eri:n,eci:r}=this.range,[l,o]=[e,t],a=s-e,h=n-e,d=r-t;if(i-t>0)this.arange=new c(s,o,n,i-1);else if(a>0)this.arange=new c(l,i,s-1,r);else if(d<0)this.arange=new c(s,r+1,n,o);else{if(!(h<0))return void(this.arange=null);this.arange=new c(n+1,i,l,r)}if(null!==this.arange){const e=this.data.getRect(this.arange);e.width+=2,e.height+=2;const{br:t,l:s,t:i,tl:n}=this;t.showAutofill(ae.call(this,e)),s.showAutofill(ce.call(this,e)),i.showAutofill(he.call(this,e)),n.showAutofill(e)}}hideAutofill(){["br","l","t","tl"].forEach((e=>{this[e].hideAutofill()}))}showClipboard(){const e=this.data.getClipboardRect();ve.call(this,e),["br","l","t","tl"].forEach((e=>{this[e].showClipboard()}))}hideClipboard(){["br","l","t","tl"].forEach((e=>{this[e].hideClipboard()}))}}function ke(e){e.preventDefault(),e.stopPropagation();const{filterItems:t}=this;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1),t[this.itemIndex].toggle())}function Ce(e){e.stopPropagation();const{filterItems:t}=this;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0),t[this.itemIndex].toggle())}function Ee(e){e.preventDefault();const{filterItems:t}=this;t.length<=0||(e.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),t[this.itemIndex].el.click(),this.hide())}function Se(e){const{keyCode:t}=e;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:case 39:default:e.stopPropagation();break;case 38:ke.call(this,e);break;case 40:Ce.call(this,e);break;case 13:case 9:Ee.call(this,e)}}class $e{constructor(e,s,i="200px"){this.filterItems=[],this.items=e,this.el=t("div",`${ie}-suggest`).css("width",i).hide(),this.itemClick=s,this.itemIndex=-1}setOffset(e){this.el.cssRemoveKeys("top","bottom").offset(e)}hide(){const{el:e}=this;this.filterItems=[],this.itemIndex=-1,e.hide(),Q(this.el.parent())}setItems(e){this.items=e}search(e){let{items:s}=this;if(/^\s*$/.test(e)||(s=s.filter((t=>(t.key||t).startsWith(e.toUpperCase())))),s=s.map((e=>{let{title:s}=e;s?"function"==typeof s&&(s=s()):s=e;const i=t("div",`${ie}-item`).child(s).on("click.stop",(()=>{this.itemClick(e),this.hide()}));return e.label&&i.child(t("div","label").html(e.label)),i})),this.filterItems=s,s.length<=0)return;const{el:i}=this;i.html("").children(...s).show(),ee(i.parent(),(()=>{this.hide()}))}bindInputEvents(e){e.on("keydown",(e=>Se.call(this,e)))}}class ze extends e{constructor(e){super("div",`${ie}-icon`),this.iconNameEl=t("div",`${ie}-icon-img ${e}`),this.child(this.iconNameEl)}setName(e){this.iconNameEl.className(`${ie}-icon-img ${e}`)}}function Te(e,t){e.setMonth(e.getMonth()+t)}function De(e,t){const s=new Date(e);return s.setDate(t-e.getDay()+1),s}class Oe{constructor(e){this.value=e,this.cvalue=new Date(e),this.headerLeftEl=t("div","calendar-header-left"),this.bodyEl=t("tbody",""),this.buildAll(),this.el=t("div","x-spreadsheet-calendar").children(t("div","calendar-header").children(this.headerLeftEl,t("div","calendar-header-right").children(t("a","calendar-prev").on("click.stop",(()=>this.prev())).child(new ze("chevron-left")),t("a","calendar-next").on("click.stop",(()=>this.next())).child(new ze("chevron-right")))),t("table","calendar-body").children(t("thead","").child(t("tr","").children(...I("calendar.weeks").map((e=>t("th","cell").child(e))))),this.bodyEl)),this.selectChange=()=>{}}setValue(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}prev(){const{value:e}=this;Te(e,-1),this.buildAll()}next(){const{value:e}=this;Te(e,1),this.buildAll()}buildAll(){this.buildHeaderLeft(),this.buildBody()}buildHeaderLeft(){const{value:e}=this;this.headerLeftEl.html(`${I("calendar.months")[e.getMonth()]} ${e.getFullYear()}`)}buildBody(){const{value:e,cvalue:s,bodyEl:i}=this,n=function(e,t,s){const i=new Date(e,t,1,23,59,59),n=[[],[],[],[],[],[]];for(let e=0;e<6;e+=1)for(let r=0;r<7;r+=1){const l=De(i,7*e+r),o=l.getMonth()!==t,a=l.getMonth()===s.getMonth()&&l.getDate()===s.getDate();n[e][r]={d:l,disabled:o,active:a}}return n}(e.getFullYear(),e.getMonth(),s).map((e=>{const s=e.map((e=>{let s="cell";return e.disabled&&(s+=" disabled"),e.active&&(s+=" active"),t("td","").child(t("div",s).on("click.stop",(()=>{this.selectChange(e.d)})).child(e.d.getDate().toString()))}));return t("tr","").children(...s)}));i.html("").children(...n)}}class Re{constructor(){this.calendar=new Oe(new Date),this.el=t("div",`${ie}-datepicker`).child(this.calendar.el).hide()}setValue(e){const{calendar:t}=this;return"string"==typeof e?/^\d{4}-\d{1,2}-\d{1,2}$/.test(e)&&t.setValue(new Date(e.replace(new RegExp("-","g"),"/"))):e instanceof Date&&t.setValue(e),this}change(e){this.calendar.selectChange=t=>{e(t),this.hide()}}show(){this.el.show()}hide(){this.el.hide()}}function Ae(){const{inputText:e}=this;if(!/^\s*$/.test(e)){const{textlineEl:t,textEl:s,areaOffset:i}=this,n=e.split("\n"),r=Math.max(...n.map((e=>e.length))),l=t.offset().width/e.length,o=(r+1)*l+5,a=this.viewFn().width-i.left-l;let h=n.length;if(o>i.width){let e=o;o>a&&(e=a,h+=parseInt(o/a,10),h+=o%a>0?1:0),s.css("width",`${e}px`)}h*=this.rowHeight,h>i.height&&s.css("height",`${h}px`)}}function Ie({target:e},t){const{value:s,selectionEnd:i}=e,n=`${s.slice(0,i)}${t}${s.slice(i)}`;e.value=n,e.setSelectionRange(i+1,i+1),this.inputText=n,this.textlineEl.html(n),Ae.call(this)}function He(e){const{keyCode:t,altKey:s}=e;13!==t&&9!==t&&e.stopPropagation(),13===t&&s&&(Ie.call(this,e,"\n"),e.stopPropagation()),13!==t||s||e.preventDefault()}function Me(e){const t=e.target.value,{suggest:s,textlineEl:i,validator:n}=this,{cell:r}=this;if(null!==r)if("editable"in r&&!0===r.editable||void 0===r.editable){if(this.inputText=t,n)"list"===n.type?s.search(t):s.hide();else{const e=t.lastIndexOf("=");-1!==e?s.search(t.substring(e+1)):s.hide()}i.html(t),Ae.call(this),this.change("input",t)}else e.target.value=r.text;else{if(this.inputText=t,n)"list"===n.type?s.search(t):s.hide();else{const e=t.lastIndexOf("=");-1!==e?s.search(t.substring(e+1)):s.hide()}i.html(t),Ae.call(this),this.change("input",t)}}function Ne(e){const{el:t}=this.textEl;setTimeout((()=>{t.focus(),t.setSelectionRange(e,e)}),0)}function Fe(e,t){const{textEl:s,textlineEl:i}=this;s.el.blur(),s.val(e),i.html(e),Ne.call(this,t)}function We(e){const{inputText:t,validator:s}=this;let i=0;if(s&&"list"===s.type)this.inputText=e,i=this.inputText.length;else{const s=t.lastIndexOf("="),n=t.substring(0,s+1);let r=t.substring(s+1);r=-1!==r.indexOf(")")?r.substring(r.indexOf(")")):"",this.inputText=`${n+e.key}(`,i=this.inputText.length,this.inputText+=`)${r}`}Fe.call(this,this.inputText,i)}function Ve(){this.suggest.setItems(this.formulas)}class _e{constructor(e,s,i){this.viewFn=s,this.rowHeight=i,this.formulas=e,this.suggest=new $e(e,(e=>{We.call(this,e)})),this.datepicker=new Re,this.datepicker.change((e=>{this.setText(function(e){let t=e.getMonth()+1,s=e.getDate();return t<10&&(t=`0${t}`),s<10&&(s=`0${s}`),`${e.getFullYear()}-${t}-${s}`}(e)),this.clear()})),this.areaEl=t("div",`${ie}-editor-area`).children(this.textEl=t("textarea","").on("input",(e=>Me.call(this,e))).on("paste.stop",(()=>{})).on("keydown",(e=>He.call(this,e))),this.textlineEl=t("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(()=>{})).on("mousedown.stop",(()=>{})),this.el=t("div",`${ie}-editor`).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=()=>{}}setFreezeLengths(e,t){this.freeze.w=e,this.freeze.h=t}clear(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Ve.call(this),this.datepicker.hide()}setOffset(e,t="top"){const{textEl:s,areaEl:i,suggest:n,freeze:r,el:l}=this;if(e){this.areaOffset=e;const{left:o,top:a,width:h,height:c,l:d,t:p}=e,u={left:0,top:0};r.w>d&&r.h>p||(r.w<d&&r.h<p?(u.left=r.w,u.top=r.h):r.w>d?u.top=r.h:r.h>p&&(u.left=r.w)),l.offset(u),i.offset({left:o-u.left-.8,top:a-u.top-.8}),s.offset({width:h-9+.8,height:c-3+.8});const f={left:0};f[t]=c,n.setOffset(f),n.hide()}}setCell(e,t){const{el:s,datepicker:i,suggest:n}=this;s.show(),this.cell=e;const r=e&&e.text||"";if(this.setText(r),this.validator=t,t){const{type:e}=t;"date"===e&&(i.show(),/^\s*$/.test(r)||i.setValue(r)),"list"===e&&(n.setItems(t.values()),n.search(""))}}setText(e){this.inputText=e,Fe.call(this,e,e.length),Ae.call(this)}}class Pe extends e{constructor(e,t=""){super("div",`${ie}-button ${t}`),this.child(I(`button.${e}`))}}function qe(){return window.devicePixelRatio||1}function Le(){return qe()-.5}function Be(e){return parseInt(e*qe(),10)}function je(e){const t=Be(e);return t>0?t-.5:.5}class Ue{constructor(e,t,s,i,n=0){this.x=e,this.y=t,this.width=s,this.height=i,this.padding=n,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}setBorders({top:e,bottom:t,left:s,right:i}){e&&(this.borderTop=e),i&&(this.borderRight=i),t&&(this.borderBottom=t),s&&(this.borderLeft=s)}innerWidth(){return this.width-2*this.padding-2}innerHeight(){return this.height-2*this.padding-2}textx(e){const{width:t,padding:s}=this;let{x:i}=this;return"left"===e?i+=s:"center"===e?i+=t/2:"right"===e&&(i+=t-s),i}texty(e,t){const{height:s,padding:i}=this;let{y:n}=this;return"top"===e?n+=i:"middle"===e?n+=s/2-t/2:"bottom"===e&&(n+=s-i-t),n}topxys(){const{x:e,y:t,width:s}=this;return[[e,t],[e+s,t]]}rightxys(){const{x:e,y:t,width:s,height:i}=this;return[[e+s,t],[e+s,t+i]]}bottomxys(){const{x:e,y:t,width:s,height:i}=this;return[[e,t+i],[e+s,t+i]]}leftxys(){const{x:e,y:t,height:s}=this;return[[e,t],[e,t+s]]}}function Ye(e,t,s,i,n,r,l){const o={x:0,y:0};"underline"===e?o.y="bottom"===n?0:"top"===n?-(r+2):-r/2:"strike"===e&&("bottom"===n?o.y=r/2:"top"===n&&(o.y=-(r/2+2))),"center"===i?o.x=l/2:"right"===i&&(o.x=l),this.line([t-o.x,s-o.y],[t-o.x+l,s-o.y])}class Xe{constructor(e,t,s){this.el=e,this.ctx=e.getContext("2d"),this.resize(t,s),this.ctx.scale(qe(),qe())}resize(e,t){this.el.style.width=`${e}px`,this.el.style.height=`${t}px`,this.el.width=Be(e),this.el.height=Be(t)}clear(){const{width:e,height:t}=this.el;return this.ctx.clearRect(0,0,e,t),this}attr(e){return Object.assign(this.ctx,e),this}save(){return this.ctx.save(),this.ctx.beginPath(),this}restore(){return this.ctx.restore(),this}beginPath(){return this.ctx.beginPath(),this}translate(e,t){return this.ctx.translate(Be(e),Be(t)),this}scale(e,t){return this.ctx.scale(e,t),this}clearRect(e,t,s,i){return this.ctx.clearRect(e,t,s,i),this}fillRect(e,t,s,i){return this.ctx.fillRect(Be(e)-.5,Be(t)-.5,Be(s),Be(i)),this}fillText(e,t,s){return this.ctx.fillText(e,Be(t),Be(s)),this}text(e,t,s={},i=!0){const{ctx:n}=this,{align:r,valign:l,font:o,color:a,strike:h,underline:c}=s,d=t.textx(r);n.save(),n.beginPath(),this.attr({textAlign:r,textBaseline:l,font:`${o.italic?"italic":""} ${o.bold?"bold":""} ${Be(o.size)}px ${o.name}`,fillStyle:a,strokeStyle:a});const p=`${e}`.split("\n"),u=t.innerWidth(),f=[];p.forEach((e=>{const t=n.measureText(e).width;if(i&&t>Be(u)){let t={w:0,len:0,start:0};for(let s=0;s<e.length;s+=1)t.w>=Be(u)&&(f.push(e.substr(t.start,t.len)),t={w:0,len:0,start:s}),t.len+=1,t.w+=n.measureText(e[s]).width+1;t.len>0&&f.push(e.substr(t.start,t.len))}else f.push(e)}));const g=(f.length-1)*(o.size+2);let x=t.texty(l,g);return f.forEach((e=>{const t=n.measureText(e).width;this.fillText(e,d,x),h&&Ye.call(this,"strike",d,x,r,l,o.size,t),c&&Ye.call(this,"underline",d,x,r,l,o.size,t),x+=o.size+2})),n.restore(),this}border(e,t){const{ctx:s}=this;return s.lineWidth=Le,s.strokeStyle=t,"medium"===e?s.lineWidth=Be(2)-.5:"thick"===e?s.lineWidth=Be(3):"dashed"===e?s.setLineDash([Be(3),Be(2)]):"dotted"===e?s.setLineDash([Be(1),Be(1)]):"double"===e&&s.setLineDash([Be(2),0]),this}line(...e){const{ctx:t}=this;if(e.length>1){t.beginPath();const[s,i]=e[0];t.moveTo(je(s),je(i));for(let s=1;s<e.length;s+=1){const[i,n]=e[s];t.lineTo(je(i),je(n))}t.stroke()}return this}strokeBorders(e){const{ctx:t}=this;t.save();const{borderTop:s,borderRight:i,borderBottom:n,borderLeft:r}=e;s&&(this.border(...s),this.line(...e.topxys())),i&&(this.border(...i),this.line(...e.rightxys())),n&&(this.border(...n),this.line(...e.bottomxys())),r&&(this.border(...r),this.line(...e.leftxys())),t.restore()}dropdown(e){const{ctx:t}=this,{x:s,y:i,width:n,height:r}=e,l=s+n-15,o=i+r-15;t.save(),t.beginPath(),t.moveTo(Be(l),Be(o)),t.lineTo(Be(l+8),Be(o)),t.lineTo(Be(l+4),Be(o+6)),t.closePath(),t.fillStyle="rgba(0, 0, 0, .45)",t.fill(),t.restore()}error(e){const{ctx:t}=this,{x:s,y:i,width:n}=e,r=s+n-1;t.save(),t.beginPath(),t.moveTo(Be(r-8),Be(i-1)),t.lineTo(Be(r),Be(i-1)),t.lineTo(Be(r),Be(i+8)),t.closePath(),t.fillStyle="rgba(255, 0, 0, .65)",t.fill(),t.restore()}frozen(e){const{ctx:t}=this,{x:s,y:i,width:n}=e,r=s+n-1;t.save(),t.beginPath(),t.moveTo(Be(r-8),Be(i-1)),t.lineTo(Be(r),Be(i-1)),t.lineTo(Be(r),Be(i+8)),t.closePath(),t.fillStyle="rgba(0, 255, 0, .85)",t.fill(),t.restore()}rect(e,t){const{ctx:s}=this,{x:i,y:n,width:r,height:l,bgcolor:o}=e;s.save(),s.beginPath(),s.fillStyle=o||"#fff",s.rect(je(i+1),je(n+1),Be(r-2),Be(l-2)),s.clip(),s.fill(),t(),s.restore()}}const Ze=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Je=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}],Ke=(e,t)=>{const[s]=e;let i=e;if('"'===s)return e.substring(1);let n=1;if("-"===s&&(i=e.substring(1),n=-1),i[0]>="0"&&i[0]<="9")return n*Number(i);const[r,l]=o(i);return n*t(r,l)},Ge=(e,t,s,i=[])=>{if("="===e[0]){const n=(e=>{const t=[],s=[];let i=[],n=0,r="",l=1,h="";for(let c=0;c<e.length;c+=1){const d=e.charAt(c);if(" "!==d){if(d>="a"&&d<="z")i.push(d.toUpperCase());else if(d>="0"&&d<="9"||d>="A"&&d<="Z"||"."===d)i.push(d);else if('"'===d){for(c+=1;'"'!==e.charAt(c);)i.push(e.charAt(c)),c+=1;s.push(`"${i.join("")}`),i=[]}else if("-"===d&&/[+\-*/,(]/.test(h))i.push(d);else{if("("!==d&&i.length>0&&s.push(i.join("")),")"===d){let e=t.pop();if(2===n)try{const[t,i]=o(s.pop()),[n,r]=o(s.pop());let l=0;for(let e=n;e<=t;e+=1)for(let t=r;t<=i;t+=1)s.push(a(e,t)),l+=1;s.push([e,l])}catch(e){}else if(1===n||3===n)3===n&&s.push(r),s.push([e,l]),l=1;else for(;"("!==e&&(s.push(e),!(t.length<=0));)e=t.pop();n=0}else if("="===d||">"===d||"<"===d){const t=e.charAt(c+1);r=d,"="!==t&&"-"!==t||(r+=t,c+=1),n=3}else if(":"===d)n=2;else if(","===d)3===n&&s.push(r),n=1,l+=1;else if("("===d&&i.length>0)t.push(i.join(""));else{if(t.length>0&&("+"===d||"-"===d)){let e=t[t.length-1];if("("!==e&&s.push(t.pop()),"*"===e||"/"===e)for(;t.length>0&&(e=t[t.length-1],"("!==e);)s.push(t.pop())}else if(t.length>0){const e=t[t.length-1];"*"!==e&&"/"!==e||s.push(t.pop())}t.push(d)}i=[]}h=d}}for(i.length>0&&s.push(i.join(""));t.length>0;)s.push(t.pop());return s})(e.substring(1));return n.length<=0?e:((e,t,s,i)=>{const n=[];for(let r=0;r<e.length;r+=1){const l=e[r],o=l[0];if("+"===l){const e=n.pop();n.push(y("+",n.pop(),e))}else if("-"===l)if(1===n.length){const e=n.pop();n.push(y("*",e,-1))}else{const e=n.pop();n.push(y("-",n.pop(),e))}else if("*"===l)n.push(y("*",n.pop(),n.pop()));else if("/"===l){const e=n.pop();n.push(y("/",n.pop(),e))}else if("="===o||">"===o||"<"===o){let e=n.pop();Number.isNaN(e)||(e=Number(e));let t=n.pop();Number.isNaN(t)||(t=Number(t));let s=!1;"="===o?s=t===e:">"===l?s=t>e:">="===l?s=t>=e:"<"===l?s=t<e:"<="===l&&(s=t<=e),n.push(s)}else if(Array.isArray(l)){const[e,s]=l,i=[];for(let e=0;e<s;e+=1)i.push(n.pop());n.push(t[e].render(i.reverse()))}else{if(i.includes(l))return 0;(o>="a"&&o<="z"||o>="A"&&o<="Z")&&i.push(l),n.push(Ke(l,s)),i.pop()}}return n[0]})(n,t,((e,n)=>Ge(s(e,n),t,s,i)),i)}return e},Qe={render:Ge},et=[{key:"SUM",title:H("formula.sum"),render:e=>e.reduce(((e,t)=>y("+",e,t)),0)},{key:"AVERAGE",title:H("formula.average"),render:e=>e.reduce(((e,t)=>Number(e)+Number(t)),0)/e.length},{key:"MAX",title:H("formula.max"),render:e=>Math.max(...e.map((e=>Number(e))))},{key:"MIN",title:H("formula.min"),render:e=>Math.min(...e.map((e=>Number(e))))},{key:"IF",title:H("formula._if"),render:([e,t,s])=>e?t:s},{key:"AND",title:H("formula.and"),render:e=>e.every((e=>e))},{key:"OR",title:H("formula.or"),render:e=>e.some((e=>e))},{key:"CONCAT",title:H("formula.concat"),render:e=>e.join("")}],tt=et,st={};et.forEach((e=>{st[e.key]=e}));const it=e=>e,nt=e=>{if(/^(-?\d*.?\d*)$/.test(e)){const t=Number(e).toFixed(2).toString(),[s,...i]=t.split("\\.");return[s.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),...i]}return e},rt=[{key:"normal",title:H("format.normal"),type:"string",render:it},{key:"text",title:H("format.text"),type:"string",render:it},{key:"number",title:H("format.number"),type:"number",label:"1,000.12",render:nt},{key:"percent",title:H("format.percent"),type:"number",label:"10.12%",render:e=>`${e}%`},{key:"rmb",title:H("format.rmb"),type:"number",label:"10.00",render:e=>`${nt(e)}`},{key:"usd",title:H("format.usd"),type:"number",label:"$10.00",render:e=>`$${nt(e)}`},{key:"eur",title:H("format.eur"),type:"number",label:"10.00",render:e=>`${nt(e)}`},{key:"date",title:H("format.date"),type:"date",label:"26/09/2008",render:it},{key:"time",title:H("format.time"),type:"date",label:"15:59:00",render:it},{key:"datetime",title:H("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:it},{key:"duration",title:H("format.duration"),type:"date",label:"24:01:00",render:it}],lt={};rt.forEach((e=>{lt[e.key]=e}));const ot={fillStyle:"#f4f5f8"},at={fillStyle:"#fff",lineWidth:Le,strokeStyle:"#e6e6e6"};function ht(e,t,s,i=0){const{left:n,top:r,width:l,height:o}=e.cellRect(t,s);return new Ue(n,r+i,l,o,5)}function ct(e,t,s,i,n=0){const{sortedRowMap:r,rows:l,cols:o}=t;if(l.isHide(s)||o.isHide(i))return;let a=s;r.has(s)&&(a=r.get(s));const h=t.getCell(a,i);if(null===h)return;let c=!1;"editable"in h&&!1===h.editable&&(c=!0);const d=t.getCellStyleOrDefault(a,i),p=ht(t,s,i,n);p.bgcolor=d.bgcolor,void 0!==d.border&&(p.setBorders(d.border),e.strokeBorders(p)),e.rect(p,(()=>{let n="";n=t.settings.evalPaused?h.text||"":Qe.render(h.text||"",st,((e,s)=>t.getCellTextOrDefault(s,e))),d.format&&(n=lt[d.format].render(n));const r=Object.assign({},d.font);r.size=function(e){for(let t=0;t<Je.length;t+=1){const s=Je[t];if(s.pt===e)return s.px}return e}(r.size),e.text(n,p,{align:d.align,valign:d.valign,font:r,color:d.color,strike:d.strike,underline:d.underline},d.textwrap),t.validations.getError(s,i)&&e.error(p),c&&e.frozen(p)}))}function dt(e){const{data:t,draw:s}=this;if(e){const{autoFilter:i}=t;if(!i.active())return;const n=i.hrange();e.intersects(n)&&n.each(((e,i)=>{const n=ht(t,e,i);s.dropdown(n)}))}}function pt(e,t,s,i,n){const{draw:r,data:l}=this;r.save(),r.translate(t,s).translate(i,n);const{exceptRowSet:o}=l,a=l.exceptRowTotalHeight(e.sri,e.eri);r.save(),r.translate(0,-a),e.each(((e,t)=>{ct(r,l,e,t)}),(e=>(e=>{const t=o.has(e);if(t){const t=l.rows.getHeight(e);r.translate(0,-t)}return!t})(e))),r.restore();const h=new Set;r.save(),r.translate(0,-a),l.eachMergesInView(e,(({sri:e,sci:t,eri:s})=>{if(o.has(e)){if(!h.has(e)){h.add(e);const t=l.rows.sumHeight(e,s+1);r.translate(0,-t)}}else ct(r,l,e,t)})),r.restore(),dt.call(this,e),r.restore()}function ut(e,t,s,i){const{draw:n}=this;n.save(),n.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(e,t,s,i),n.restore()}function ft(e,t,s,i,n,l){const{draw:o,data:a}=this,h=t.h,c=t.w,d=l+i,p=n+s;o.save(),o.attr(ot),"all"!==e&&"left"!==e||o.fillRect(0,d,s,h),"all"!==e&&"top"!==e||o.fillRect(p,0,c,i);const{sri:u,sci:f,eri:g,eci:x}=a.selector.range;o.attr({textAlign:"center",textBaseline:"middle",font:`500 ${Be(12)}px Source Sans Pro`,fillStyle:"#585757",lineWidth:Le(),strokeStyle:"#e6e6e6"}),"all"!==e&&"left"!==e||(a.rowEach(t.sri,t.eri,((e,t,i)=>{const n=d+t,r=e;o.line([0,n],[s,n]),u<=r&&r<g+1&&ut.call(this,0,n,s,i),o.fillText(r+1,s/2,n+i/2),e>0&&a.rows.isHide(e-1)&&(o.save(),o.attr({strokeStyle:"#c6c6c6"}),o.line([5,n+5],[s-5,n+5]),o.restore())})),o.line([0,h+d],[s,h+d]),o.line([s,d],[s,h+d])),"all"!==e&&"top"!==e||(a.colEach(t.sci,t.eci,((e,t,s)=>{const n=p+t,l=e;o.line([n,0],[n,i]),f<=l&&l<x+1&&ut.call(this,n,0,s,i),o.fillText(r(l),n+s/2,i/2),e>0&&a.cols.isHide(e-1)&&(o.save(),o.attr({strokeStyle:"#c6c6c6"}),o.line([n+5,5],[n+5,i-5]),o.restore())})),o.line([c+p,0],[c+p,i]),o.line([0,i],[c+p,i])),o.restore()}function gt(e,t){const{draw:s}=this;s.save(),s.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,e,t),s.restore()}function xt({sri:e,sci:t,eri:s,eci:i,w:n,h:r},l,o,a,h){const{draw:c,data:d}=this,{settings:p}=d;c.save(),c.attr(at).translate(l+a,o+h),p.showGrid?(d.rowEach(e,s,((t,i,r)=>{t!==e&&c.line([0,i],[n,i]),t===s&&c.line([0,i+r],[n,i+r])})),d.colEach(t,i,((e,s,n)=>{e!==t&&c.line([s,0],[s,r]),e===i&&c.line([s+n,0],[s+n,r])})),c.restore()):c.restore()}function mt(e,t,s,i){const{draw:n,data:r}=this,l=r.viewWidth()-e,o=r.viewHeight()-t;n.save().translate(e,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),n.line([0,i],[l,i]),n.line([s,0],[s,o]),n.restore()}const bt=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],wt=["landscape","portrait"];function vt(e){return parseInt(96*e,10)}function yt(e){"cancel"===e?this.el.hide():this.toPrint()}function kt(e){const{paper:t}=this,{value:s}=e.target,i=bt[s];t.w=vt(i[1]),t.h=vt(i[2]),this.preview()}function Ct(e){const{paper:t}=this,{value:s}=e.target,i=wt[s];t.orientation=i,this.preview()}class Et{constructor(e){this.paper={w:vt(bt[0][1]),h:vt(bt[0][2]),padding:50,orientation:wt[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=t("div",`${ie}-print`).children(t("div",`${ie}-print-bar`).children(t("div","-title").child("Print settings"),t("div","-right").children(t("div",`${ie}-buttons`).children(new Pe("cancel").on("click",yt.bind(this,"cancel")),new Pe("next","primary").on("click",yt.bind(this,"next"))))),t("div",`${ie}-print-content`).children(this.contentEl=t("div","-content"),t("div","-sider").child(t("form","").children(t("fieldset","").children(t("label","").child(`${I("print.size")}`),t("select","").children(...bt.map(((e,s)=>t("option","").attr("value",s).child(`${e[0]} ( ${e[1]}''x${e[2]}'' )`)))).on("change",kt.bind(this))),t("fieldset","").children(t("label","").child(`${I("print.orientation")}`),t("select","").children(...wt.map(((e,s)=>t("option","").attr("value",s).child(`${I("print.orientations")[s]}`)))).on("change",Ct.bind(this))))))).hide()}resetData(e){this.data=e}preview(){const{data:e,paper:s}=this,{width:i,height:n,padding:r}=s,l=i-2*r,o=n-2*r,a=e.contentRange(),h=parseInt(a.h/o,10)+1,c=l/a.w;let d=r;const p=r;c>1&&(d+=(l-a.w)/2);let u=0,f=0;this.contentEl.html(""),this.canvases=[];const g={sri:0,sci:0,eri:0,eci:0};for(let s=0;s<h;s+=1){let s=0,r=0;const l=t("div",`${ie}-canvas-card`),h=t("canvas",`${ie}-canvas`);this.canvases.push(h.el);const x=new Xe(h.el,i,n);for(x.save(),x.translate(d,p),c<1&&x.scale(c,c);u<=a.eri;u+=1){const t=e.rows.getHeight(u);if(s+=t,!(s<o)){r=-(s-t);break}for(let t=0;t<=a.eci;t+=1)ct(x,e,u,t,f),g.eci=t}g.eri=u,x.restore(),x.save(),x.translate(d,p),c<1&&x.scale(c,c);const m=f;e.eachMergesInView(g,(({sri:t,sci:s})=>{ct(x,e,t,s,m)})),x.restore(),g.sri=g.eri,g.sci=g.eci,f+=r,this.contentEl.child(t("div",`${ie}-canvas-card-wraper`).child(l.child(h)))}this.el.show()}toPrint(){this.el.hide();const{paper:e}=this,s=t("iframe","").hide(),{el:i}=s;window.document.body.appendChild(i);const{contentWindow:n}=i,r=n.document,l=document.createElement("style");l.innerHTML=`\n      @page { size: ${e.width}px ${e.height}px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    `,r.head.appendChild(l),this.canvases.forEach((e=>{const t=e.cloneNode(!1);t.getContext("2d").drawImage(e,0,0),r.body.appendChild(t)})),n.print()}}const St=[{key:"copy",title:H("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:H("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:H("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:H("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:H("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:H("contextmenu.insertRow")},{key:"insert-column",title:H("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:H("contextmenu.deleteRow")},{key:"delete-column",title:H("contextmenu.deleteColumn")},{key:"delete-cell-text",title:H("contextmenu.deleteCellText")},{key:"hide",title:H("contextmenu.hide")},{key:"divider"},{key:"validation",title:H("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:H("contextmenu.cellprintable")},{key:"cell-non-printable",title:H("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:H("contextmenu.celleditable")},{key:"cell-non-editable",title:H("contextmenu.cellnoneditable")}];function $t(e){return"divider"===e.key?t("div",`${ie}-item divider`):t("div",`${ie}-item`).on("click",(()=>{this.itemClick(e.key),this.hide()})).children(e.title(),t("div","label").child(e.label||""))}function zt(){return St.map((e=>$t.call(this,e)))}class Tt{constructor(e,s=!1){this.menuItems=zt.call(this),this.el=t("div",`${ie}-contextmenu`).children(...this.menuItems).hide(),this.viewFn=e,this.itemClick=()=>{},this.isHide=s,this.setMode("range")}setMode(e){const t=this.menuItems[12];"row-col"===e?t.show():t.hide()}hide(){const{el:e}=this;e.hide(),Q(e)}setPosition(e,t){if(this.isHide)return;const{el:s}=this,{width:i}=s.show().offset(),n=this.viewFn(),r=n.height/2;let l=e;n.width-e<=i&&(l-=i),s.css("left",`${l}px`),t>r?s.css("bottom",n.height-t+"px").css("max-height",`${t}px`).css("top","auto"):s.css("top",`${t}px`).css("max-height",n.height-t+"px").css("bottom","auto"),ee(s)}}class Dt{constructor(e,t,s){this.tip=I(`toolbar.${e.replace(/-[a-z]/g,(e=>e[1].toUpperCase()))}`),t&&(this.tip+=` (${t})`),this.tag=e,this.shortcut=t,this.value=s,this.el=this.element(),this.change=()=>{}}element(){const{tip:e}=this;return t("div",`${ie}-toolbar-btn`).on("mouseenter",(s=>{!function(e,s){if(s.classList.contains("active"))return;const{left:i,top:n,width:r,height:l}=s.getBoundingClientRect(),o=t("div",`${ie}-tooltip`).html(e).show();document.body.appendChild(o.el);const a=o.box();o.css("left",i+r/2-a.width/2+"px").css("top",`${n+l+2}px`),K(s,"mouseleave",(()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)})),K(s,"click",(()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)}))}(e,s.target)})).attr("data-tooltip",e)}setState(){}}class Ot extends Dt{dropdown(){}getValue(e){return e}element(){const{tag:e}=this;return this.dd=this.dropdown(),this.dd.change=t=>this.change(e,this.getValue(t)),super.element().child(this.dd)}setState(e){e&&(this.value=e,this.dd.setTitle(e))}}class Rt extends e{constructor(e,s,i,n,...r){super("div",`${ie}-dropdown ${n}`),this.title=e,this.change=()=>{},this.headerClick=()=>{},"string"==typeof e?this.title=t("div",`${ie}-dropdown-title`).child(e):i&&this.title.addClass("arrow-left"),this.contentEl=t("div",`${ie}-dropdown-content`).css("width",s).hide(),this.setContentChildren(...r),this.headerEl=t("div",`${ie}-dropdown-header`),this.headerEl.on("click",(()=>{"block"!==this.contentEl.css("display")?this.show():this.hide()})).children(this.title,i?t("div",`${ie}-icon arrow-right`).child(t("div",`${ie}-icon-img arrow-down`)):""),this.children(this.headerEl,this.contentEl)}setContentChildren(...e){this.contentEl.html(""),e.length>0&&this.contentEl.children(...e)}setTitle(e){this.title.html(e),this.hide()}show(){const{contentEl:e}=this;e.show(),this.parent().active(),ee(this.parent(),(()=>{this.hide()}))}hide(){this.parent().active(!1),this.contentEl.hide(),Q(this.parent())}}class At extends Rt{constructor(e,s){super(new ze(`align-${s}`),"auto",!0,"bottom-left",...e.map((e=>{return(s=`align-${e}`,t("div",`${ie}-item`).child(new ze(s))).on("click",(()=>{this.setTitle(e),this.change(e)}));var s})))}setTitle(e){this.title.setName(`align-${e}`),this.hide()}}class It extends Ot{constructor(e){super("align","",e)}dropdown(){const{value:e}=this;return new At(["left","center","right"],e)}}class Ht extends Ot{constructor(e){super("valign","",e)}dropdown(){const{value:e}=this;return new At(["top","middle","bottom"],e)}}class Mt extends Dt{element(){const{tag:e}=this;return super.element().child(new ze(e)).on("click",(()=>this.click()))}click(){this.change(this.tag,this.toggle())}setState(e){this.el.active(e)}toggle(){return this.el.toggle()}active(){return this.el.hasClass("active")}}class Nt extends Mt{constructor(){super("autofilter")}setState(){}}class Ft extends Mt{constructor(){super("font-bold","Ctrl+B")}}class Wt extends Mt{constructor(){super("font-italic","Ctrl+I")}}class Vt extends Mt{constructor(){super("strike","Ctrl+U")}}class _t extends Mt{constructor(){super("underline","Ctrl+U")}}const Pt=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],qt=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Lt=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function Bt(e){return t("td","").child(t("div",`${ie}-color-palette-cell`).on("click.stop",(()=>this.change(e))).css("background-color",e))}class jt{constructor(){this.el=t("div",`${ie}-color-palette`),this.change=()=>{};const e=t("table","").children(t("tbody","").children(t("tr",`${ie}-theme-color-placeholders`).children(...Pt.map((e=>Bt.call(this,e)))),...qt.map((e=>t("tr",`${ie}-theme-colors`).children(...e.map((e=>Bt.call(this,e)))))),t("tr",`${ie}-standard-colors`).children(...Lt.map((e=>Bt.call(this,e))))));this.el.child(e)}}class Ut extends Rt{constructor(e,t){const s=new ze(e).css("height","16px").css("border-bottom",`3px solid ${t}`),i=new jt;i.change=e=>{this.setTitle(e),this.change(e)},super(s,"auto",!1,"bottom-left",i.el)}setTitle(e){this.title.css("border-color",e),this.hide()}}const Yt=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']];class Xt extends Rt{constructor(e){const s=new ze("line-type");let i=0;const n=Yt.map(((s,r)=>t("div",`${ie}-item state ${e===s[0]?"checked":""}`).on("click",(()=>{n[i].toggle("checked"),n[r].toggle("checked"),i=r,this.hide(),this.change(s)})).child(t("div",`${ie}-line-type`).html(s[1]))));super(s,"auto",!1,"bottom-left",...n)}}function Zt(...e){return t("table","").child(t("tbody","").children(...e))}function Jt(e){return t("td","").child(t("div",`${ie}-border-palette-cell`).child(new ze(`border-${e}`)).on("click",(()=>{this.mode=e;const{mode:t,style:s,color:i}=this;this.change({mode:t,style:s,color:i})})))}class Kt{constructor(){this.color="#000",this.style="thin",this.mode="all",this.change=()=>{},this.ddColor=new Ut("line-color",this.color),this.ddColor.change=e=>{this.color=e},this.ddType=new Xt(this.style),this.ddType.change=([e])=>{this.style=e},this.el=t("div",`${ie}-border-palette`);const e=Zt(t("tr","").children(t("td",`${ie}-border-palette-left`).child(Zt(t("tr","").children(...["all","inside","horizontal","vertical","outside"].map((e=>Jt.call(this,e)))),t("tr","").children(...["left","top","right","bottom","none"].map((e=>Jt.call(this,e)))))),t("td",`${ie}-border-palette-right`).children(t("div",`${ie}-toolbar-btn`).child(this.ddColor.el),t("div",`${ie}-toolbar-btn`).child(this.ddType.el))));this.el.child(e)}}class Gt extends Rt{constructor(){const e=new ze("border-all"),t=new Kt;t.change=e=>{this.change(e),this.hide()},super(e,"auto",!1,"bottom-left",t.el)}}class Qt extends Ot{constructor(){super("border")}dropdown(){return new Gt}}class es extends Dt{element(){return super.element().child(new ze(this.tag)).on("click",(()=>this.change(this.tag)))}setState(e){this.el.disabled(e)}}class ts extends es{constructor(){super("clearformat")}}class ss extends Mt{constructor(){super("paintformat")}setState(){}}class is extends Ot{constructor(e){super("color",void 0,e)}dropdown(){const{tag:e,value:t}=this;return new Ut(e,t)}}class ns extends Ot{constructor(e){super("bgcolor",void 0,e)}dropdown(){const{tag:e,value:t}=this;return new Ut(e,t)}}class rs extends Rt{constructor(){super("10","60px",!0,"bottom-left",...Je.map((e=>t("div",`${ie}-item`).on("click",(()=>{this.setTitle(`${e.pt}`),this.change(e)})).child(`${e.pt}`))))}}class ls extends Ot{constructor(){super("font-size")}getValue(e){return e.pt}dropdown(){return new rs}}class os extends Rt{constructor(){const e=Ze.map((e=>t("div",`${ie}-item`).on("click",(()=>{this.setTitle(e.title),this.change(e)})).child(e.title)));super(Ze[0].title,"160px",!0,"bottom-left",...e)}}class as extends Ot{constructor(){super("font-name")}getValue(e){return e.key}dropdown(){return new os}}class hs extends Rt{constructor(){let e=rt.slice(0);e.splice(2,0,{key:"divider"}),e.splice(8,0,{key:"divider"}),e=e.map((e=>{const s=t("div",`${ie}-item`);return"divider"===e.key?s.addClass("divider"):(s.child(e.title()).on("click",(()=>{this.setTitle(e.title()),this.change(e)})),e.label&&s.child(t("div","label").html(e.label))),s})),super("Normal","220px",!0,"bottom-left",...e)}setTitle(e){for(let t=0;t<rt.length;t+=1)rt[t].key===e&&this.title.html(rt[t].title());this.hide()}}class cs extends Ot{constructor(){super("format")}getValue(e){return e.key}dropdown(){return new hs}}class ds extends Rt{constructor(){const e=et.map((e=>t("div",`${ie}-item`).on("click",(()=>{this.hide(),this.change(e)})).child(e.key)));super(new ze("formula"),"180px",!0,"bottom-left",...e)}}class ps extends Ot{constructor(){super("formula")}getValue(e){return e.key}dropdown(){return new ds}}class us extends Mt{constructor(){super("freeze")}}class fs extends Mt{constructor(){super("merge")}setState(e,t){this.el.active(e).disabled(t)}}class gs extends es{constructor(){super("redo","Ctrl+Y")}}class xs extends es{constructor(){super("undo","Ctrl+Z")}}class ms extends es{constructor(){super("print","Ctrl+P")}}class bs extends Mt{constructor(){super("textwrap")}}class ws extends Rt{constructor(){const e=new ze("ellipsis"),s=t("div",`${ie}-toolbar-more`);super(e,"auto",!1,"bottom-right",s),this.moreBtns=s,this.contentEl.css("max-width","420px")}}class vs extends Ot{constructor(){super("more"),this.el.hide()}dropdown(){return new ws}show(){this.el.show()}hide(){this.el.hide()}}function ys(){return t("div",`${ie}-toolbar-divider`)}function ks(){this.btns2=[],this.items.forEach((e=>{if(Array.isArray(e))e.forEach((({el:e})=>{const t=e.box(),{marginLeft:s,marginRight:i}=e.computedStyle();this.btns2.push([e,t.width+parseInt(s,10)+parseInt(i,10)])}));else{const t=e.box(),{marginLeft:s,marginRight:i}=e.computedStyle();this.btns2.push([e,t.width+parseInt(s,10)+parseInt(i,10)])}}))}function Cs(){const{el:e,btns:t,moreEl:s,btns2:i}=this,{moreBtns:n,contentEl:r}=s.dd;e.css("width",this.widthFn()-60+"px");const l=e.box();let o=160,a=12;const h=[],c=[];i.forEach((([e,t],s)=>{o+=t,s===i.length-1||o<l.width?h.push(e):(a+=t,c.push(e))})),t.html("").children(...h),n.html("").children(...c),r.css("width",`${a}px`),c.length>0?s.show():s.hide()}class Es{constructor(e,s,i=!1){this.data=e,this.change=()=>{},this.widthFn=s,this.isHide=i;const n=e.defaultStyle();this.items=[[this.undoEl=new xs,this.redoEl=new gs,new ms,this.paintformatEl=new ss,this.clearformatEl=new ts],ys(),[this.formatEl=new cs],ys(),[this.fontEl=new as,this.fontSizeEl=new ls],ys(),[this.boldEl=new Ft,this.italicEl=new Wt,this.underlineEl=new _t,this.strikeEl=new Vt,this.textColorEl=new is(n.color)],ys(),[this.fillColorEl=new ns(n.bgcolor),this.borderEl=new Qt,this.mergeEl=new fs],ys(),[this.alignEl=new It(n.align),this.valignEl=new Ht(n.valign),this.textwrapEl=new bs],ys(),[this.freezeEl=new us,this.autofilterEl=new Nt,this.formulaEl=new ps,this.moreEl=new vs]],this.el=t("div",`${ie}-toolbar`),this.btns=t("div",`${ie}-toolbar-btns`),this.items.forEach((e=>{Array.isArray(e)?e.forEach((e=>{this.btns.child(e.el),e.change=(...e)=>{this.change(...e)}})):this.btns.child(e.el)})),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout((()=>{ks.call(this),Cs.call(this)}),0),K(window,"resize",(()=>{Cs.call(this)})))}paintformatActive(){return this.paintformatEl.active()}paintformatToggle(){this.paintformatEl.toggle()}trigger(e){this[`${e}El`].click()}resetData(e){this.data=e,this.reset()}reset(){if(this.isHide)return;const{data:e}=this,t=e.getSelectedCellStyle();this.undoEl.setState(!e.canUndo()),this.redoEl.setState(!e.canRedo()),this.mergeEl.setState(e.canUnmerge(),!e.selector.multiple()),this.autofilterEl.setState(!e.canAutofilter());const{font:s,format:i}=t;this.formatEl.setState(i),this.fontEl.setState(s.name),this.fontSizeEl.setState(s.size),this.boldEl.setState(s.bold),this.italicEl.setState(s.italic),this.underlineEl.setState(t.underline),this.strikeEl.setState(t.strike),this.textColorEl.setState(t.color),this.fillColorEl.setState(t.bgcolor),this.alignEl.setState(t.align),this.valignEl.setState(t.valign),this.textwrapEl.setState(t.textwrap),this.freezeEl.setState(e.freezeIsActive())}}class Ss{constructor(e,s){this.vchange=()=>{},this.el=t("div",`${ie}-form-input`),this.input=t("input","").css("width",e).on("input",(e=>this.vchange(e))).attr("placeholder",s),this.el.child(this.input)}focus(){setTimeout((()=>{this.input.el.focus()}),10)}hint(e){this.input.attr("placeholder",e)}val(e){return this.input.val(e)}}class $s{constructor(e,s,i,n=(e=>e),r=(()=>{})){this.key=e,this.getTitle=n,this.vchange=()=>{},this.el=t("div",`${ie}-form-select`),this.suggest=new $e(s.map((e=>({key:e,title:this.getTitle(e)}))),(e=>{this.itemClick(e.key),r(e.key),this.vchange(e.key)}),i,this.el),this.el.children(this.itemEl=t("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(()=>this.show()))}show(){this.suggest.search("")}itemClick(e){this.key=e,this.itemEl.html(this.getTitle(e))}val(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}const zs={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/};class Ts{constructor(e,s,i,n){this.label="",this.rule=s,i&&(this.label=t("label","label").css("width",`${n}px`).html(i)),this.tip=t("div","tip").child("tip").hide(),this.input=e,this.input.vchange=()=>this.validate(),this.el=t("div",`${ie}-form-field`).children(this.label,e.el,this.tip)}isShow(){return"none"!==this.el.css("display")}show(){this.el.show()}hide(){return this.el.hide(),this}val(e){return this.input.val(e)}hint(e){this.input.hint(e)}validate(){const{input:e,rule:t,tip:s,el:i}=this,n=e.val();return t.required&&/^\s*$/.test(n)?(s.html(I("validation.required")),i.addClass("error"),!1):!t.type&&!t.pattern||(t.pattern||zs[t.type]).test(n)?(i.removeClass("error"),!0):(s.html(I("validation.notMatch")),i.addClass("error"),!1)}}class Ds extends class{constructor(e,s,i="600px"){this.title=e,this.el=t("div",`${ie}-modal`).css("width",i).children(t("div",`${ie}-modal-header`).children(new ze("close").on("click.stop",(()=>this.hide())),this.title),t("div",`${ie}-modal-content`).children(...s)).hide()}show(){this.dimmer=t("div",`${ie}-dimmer active`),document.body.appendChild(this.dimmer.el);const{width:e,height:s}=this.el.show().box(),{clientHeight:i,clientWidth:n}=document.documentElement;this.el.offset({left:(n-e)/2,top:(i-s)/3}),window.xkeydownEsc=e=>{27===e.keyCode&&this.hide()},K(window,"keydown",window.xkeydownEsc)}hide(){this.el.hide(),document.body.removeChild(this.dimmer.el),G(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}{constructor(){const e=new Ts(new $s("cell",["cell"],"100%",(e=>I(`dataValidation.modeType.${e}`))),{required:!0},`${I("dataValidation.range")}:`,100),s=new Ts(new Ss("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new Ts(new $s("list",["list","number","date","phone","email"],"100%",(e=>I(`dataValidation.type.${e}`)),(e=>this.criteriaSelected(e))),{required:!0},`${I("dataValidation.criteria")}:`,100),n=new Ts(new $s("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(e=>I(`dataValidation.operator.${e}`)),(e=>this.criteriaOperatorSelected(e))),{required:!0}).hide(),r=new Ts(new Ss("70px","10"),{required:!0}).hide(),l=new Ts(new Ss("70px","100"),{required:!0,type:"number"}).hide(),o=new Ts(new Ss("120px","a,b,c"),{required:!0}),a=new Ts(new Ss("70px","10"),{required:!0,type:"number"}).hide();super(I("contextmenu.validation"),[t("div",`${ie}-form-fields`).children(e.el,s.el),t("div",`${ie}-form-fields`).children(i.el,n.el,r.el,l.el,a.el,o.el),t("div",`${ie}-buttons`).children(new Pe("cancel").on("click",(()=>this.btnClick("cancel"))),new Pe("remove").on("click",(()=>this.btnClick("remove"))),new Pe("save","primary").on("click",(()=>this.btnClick("save"))))]),this.mf=e,this.rf=s,this.cf=i,this.of=n,this.minvf=r,this.maxvf=l,this.vf=a,this.svf=o,this.change=()=>{}}showVf(e){const t="date"===e?"2018-11-12":"10",{vf:s}=this;s.input.hint(t),s.show()}criteriaSelected(e){const{of:t,minvf:s,maxvf:i,vf:n,svf:r}=this;"date"===e||"number"===e?(t.show(),s.rule.type=e,i.rule.type=e,"date"===e?(s.hint("2018-11-12"),i.hint("2019-11-12")):(s.hint("10"),i.hint("100")),s.show(),i.show(),n.hide(),r.hide()):("list"===e?r.show():r.hide(),n.hide(),t.hide(),s.hide(),i.hide())}criteriaOperatorSelected(e){if(!e)return;const{minvf:t,maxvf:s,vf:i}=this;if("be"===e||"nbe"===e)t.show(),s.show(),i.hide();else{const e=this.cf.val();i.rule.type=e,"date"===e?i.hint("2018-11-12"):i.hint("10"),i.show(),t.hide(),s.hide()}}btnClick(e){if("cancel"===e)this.hide();else if("remove"===e)this.change("remove"),this.hide();else if("save"===e){const e=["mf","rf","cf","of","svf","vf","minvf","maxvf"];for(let t=0;t<e.length;t+=1){const s=this[e[t]];if(s.isShow()&&!s.validate())return}const t=this.mf.val(),s=this.rf.val(),i=this.cf.val(),n=this.of.val();let r=this.svf.val();"number"!==i&&"date"!==i||(r="be"===n||"nbe"===n?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",t,s,{type:i,operator:n,required:!1,value:r}),this.hide()}}setValue(e){if(e){const{mf:t,rf:s,cf:i,of:n,svf:r,vf:l,minvf:o,maxvf:a}=this,{mode:h,ref:c,validator:d}=e,{type:p,operator:u,value:f}=d||{type:"list"};t.val(h||"cell"),s.val(c),i.val(p),n.val(u),Array.isArray(f)?(o.val(f[0]),a.val(f[1])):(r.val(f||""),l.val(f||"")),this.criteriaSelected(p),this.criteriaOperatorSelected(u)}this.show()}}function Os(e){return t("div",`${ie}-item ${e}`)}function Rs(e){return Os("state").child(I(`sort.${e}`)).on("click.stop",(()=>this.itemClick(e)))}function As(e){const{filterbEl:s,filterValues:i}=this;s.html(""),Object.keys(e).forEach(((n,r)=>{const l=e[n],o=i.includes(n)?"checked":"";s.child(t("div",`${ie}-item state ${o}`).on("click.stop",(()=>this.filterClick(r,n))).children(""===n?I("filter.empty"):n,t("div","label").html(`(${l})`)))}))}function Is(){const{filterhEl:e,filterValues:t,values:s}=this;e.html(`${t.length} / ${s.length}`),e.checked(t.length===s.length)}class Hs{constructor(){this.filterbEl=t("div",`${ie}-body`),this.filterhEl=t("div",`${ie}-header state`).on("click.stop",(()=>this.filterClick(0,"all"))),this.el=t("div",`${ie}-sort-filter`).children(this.sortAscEl=Rs.call(this,"asc"),this.sortDescEl=Rs.call(this,"desc"),Os("divider"),t("div",`${ie}-filter`).children(this.filterhEl,this.filterbEl),t("div",`${ie}-buttons`).children(new Pe("cancel").on("click",(()=>this.btnClick("cancel"))),new Pe("ok","primary").on("click",(()=>this.btnClick("ok"))))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}btnClick(e){if("ok"===e){const{ci:e,sort:t,filterValues:s}=this;this.ok&&this.ok(e,t,"in",s)}this.hide()}itemClick(e){this.sort=e;const{sortAscEl:t,sortDescEl:s}=this;t.checked("asc"===e),s.checked("desc"===e)}filterClick(e,s){const{filterbEl:i,filterValues:n,values:r}=this,l=i.children();"all"===s?l.length===n.length?(this.filterValues=[],l.forEach((e=>t(e).checked(!1)))):(this.filterValues=Array.from(r),l.forEach((e=>t(e).checked(!0)))):t(l[e]).toggle("checked")?n.push(s):n.splice(n.findIndex((e=>e===s)),1),Is.call(this)}set(e,t,s,i){this.ci=e;const{sortAscEl:n,sortDescEl:r}=this;null!==i?(this.sort=i.order,n.checked(i.asc()),r.checked(i.desc())):(this.sortDesc=null,n.checked(!1),r.checked(!1)),this.values=Object.keys(t),this.filterValues=s?Array.from(s.value):Object.keys(t),As.call(this,t,s),Is.call(this)}setOffset(e){this.el.offset(e).show();let t=1;ee(this.el,(()=>{t<=0&&this.hide(),t-=1}))}show(){this.el.show()}hide(){this.el.hide(),Q(this.el)}}function Ms(e,s){const i=t("div",`${ie}-toast`),n=t("div",`${ie}-dimmer active`);i.children(t("div",`${ie}-toast-header`).children(new ze("close").on("click.stop",(()=>(document.body.removeChild(i.el),void document.body.removeChild(n.el)))),e),t("div",`${ie}-toast-content`).html(s)),document.body.appendChild(i.el),document.body.appendChild(n.el);const{width:r,height:l}=i.box(),{clientHeight:o,clientWidth:a}=document.documentElement;i.offset({left:(a-r)/2,top:(o-l)/3})}function Ns(e,t){let s;return(...i)=>{const n=this,r=i;s||(s=setTimeout((()=>{s=null,e.apply(n,r)}),t))}}function Fs(){const{data:e,verticalScrollbar:t,horizontalScrollbar:s}=this,{l:i,t:n,left:r,top:l,width:o,height:a}=e.getSelectedRect(),h=this.getTableOffset();if(Math.abs(r)+o>h.width)s.move({left:i+o-h.width});else{const t=e.freezeTotalWidth();r<t&&s.move({left:i-1-t})}if(Math.abs(l)+a>h.height)t.move({top:n+a-h.height-1});else{const s=e.freezeTotalHeight();l<s&&t.move({top:n-1-s})}}function Ws(e,t,s,i=!0,n=!1){if(-1===t&&-1===s)return;const{table:r,selector:l,toolbar:o,data:a,contextMenu:h}=this;h.setMode(-1===t||-1===s?"row-col":"range");const c=a.getCell(t,s);e?(l.setEnd(t,s,n),this.trigger("cells-selected",c,l.range)):(l.set(t,s,i),this.trigger("cell-selected",c,t,s)),o.reset(),r.render()}function Vs(e,t){const{selector:s,data:i}=this,{rows:n,cols:r}=i;let[l,o]=s.indexes;const{eri:a,eci:h}=s.range;e&&([l,o]=s.moveIndexes),"left"===t?o>0&&(o-=1):"right"===t?(h!==o&&(o=h),o<r.len-1&&(o+=1)):"up"===t?l>0&&(l-=1):"down"===t?(a!==l&&(l=a),l<n.len-1&&(l+=1)):"row-first"===t?o=0:"row-last"===t?o=r.len-1:"col-first"===t?l=0:"col-last"===t&&(l=n.len-1),e&&(s.moveIndexes=[l,o]),Ws.call(this,e,l,o),Fs.call(this)}function _s(e){if(0!==e.buttons)return;if(e.target.className===`${ie}-resizer-hover`)return;const{offsetX:t,offsetY:s}=e,{rowResizer:i,colResizer:n,tableEl:r,data:l}=this,{rows:o,cols:a}=l;if(t>a.indexWidth&&s>o.height)return i.hide(),void n.hide();const h=r.box(),c=l.getCellRectByXY(e.offsetX,e.offsetY);c.ri>=0&&-1===c.ci?(c.width=a.indexWidth,i.show(c,{width:h.width}),o.isHide(c.ri-1)?i.showUnhide(c.ri):i.hideUnhide()):i.hide(),-1===c.ri&&c.ci>=0?(c.height=o.height,n.show(c,{height:h.height}),a.isHide(c.ci-1)?n.showUnhide(c.ci):n.hideUnhide()):n.hide()}function Ps(e){const{verticalScrollbar:t,horizontalScrollbar:s,data:i}=this,{top:n}=t.scroll(),{left:r}=s.scroll(),{rows:l,cols:o}=i,{deltaY:a,deltaX:h}=e,c=(e,t)=>{let s=e,i=0;do{i=t(s),s+=1}while(i<=0);return i},d=e=>{if(e>0){const e=i.scroll.ri+1;if(e<l.len){const s=c(e,(e=>l.getHeight(e)));t.move({top:n+s-1})}}else{const e=i.scroll.ri-1;if(e>=0){const s=c(e,(e=>l.getHeight(e)));t.move({top:0===e?0:n-s})}}},p=Math.abs(a),u=Math.abs(h),f=Math.max(p,u);/Firefox/i.test(window.navigator.userAgent)&&Ns(d(e.detail),50),f===u&&Ns((e=>{if(e>0){const e=i.scroll.ci+1;if(e<o.len){const t=c(e,(e=>o.getWidth(e)));s.move({left:r+t-1})}}else{const e=i.scroll.ci-1;if(e>=0){const t=c(e,(e=>o.getWidth(e)));s.move({left:0===e?0:r-t})}}})(h),50),f===p&&Ns(d(a),50)}function qs(e,t){const{verticalScrollbar:s,horizontalScrollbar:i}=this,{top:n}=s.scroll(),{left:r}=i.scroll();"left"===e||"right"===e?i.move({left:r-t}):"up"!==e&&"down"!==e||s.move({top:n-t})}function Ls(){const{data:e,verticalScrollbar:t}=this,{height:s}=this.getTableOffset(),i=e.exceptRowTotalHeight(0,-1);t.set(s,e.rows.totalHeight()-i)}function Bs(){const{data:e,horizontalScrollbar:t}=this,{width:s}=this.getTableOffset();e&&t.set(s,e.cols.totalWidth())}function js(){const{selector:e,data:t,editor:s}=this,[i,n]=t.freeze;if(i>0||n>0){const e=t.freezeTotalWidth(),i=t.freezeTotalHeight();s.setFreezeLengths(e,i)}e.resetAreaOffset()}function Us(){const{tableEl:e,overlayerEl:t,overlayerCEl:s,table:i,toolbar:n,selector:r,el:l}=this,o=this.getTableOffset(),a=this.getRect();e.attr(a),t.offset(a),s.offset(o),l.css("width",`${a.width}px`),Ls.call(this),Bs.call(this),js.call(this),i.render(),n.reset(),r.reset()}function Ys(){const{data:e,selector:t}=this;e.clearClipboard(),t.hideClipboard()}function Xs(){const{data:e,selector:t}=this;e.copy(),e.copyToSystemClipboard(),t.showClipboard()}function Zs(){const{data:e,selector:t}=this;e.cut(),t.showClipboard()}function Js(e,t){const{data:s}=this;if("read"!==s.settings.mode)if(s.paste(e,(e=>Ms("Tip",e))))Us.call(this);else if(t){const e=t.clipboardData.getData("text/plain");this.data.pasteFromText(e),Us.call(this)}}function Ks(){this.data.hideRowsOrCols(),Us.call(this)}function Gs(e,t){this.data.unhideRowsOrCols(e,t),Us.call(this)}function Qs(){const{data:e}=this;e.autofilter(),Us.call(this)}function ei(){const{toolbar:e}=this;e.paintformatActive()&&(Js.call(this,"format"),Ys.call(this),e.paintformatToggle())}function ti(e){const{selector:t,data:s,table:i,sortFilter:n}=this,{offsetX:r,offsetY:l}=e,o=e.target.className===`${ie}-selector-corner`,a=s.getCellRectByXY(r,l),{left:h,top:c,width:d,height:p}=a;let{ri:u,ci:f}=a;const{autoFilter:g}=s;if(g.includes(u,f)&&h+d-20<r&&c+p-20<l){const e=g.items(f,((e,t)=>s.rows.getCell(e,t)));return n.hide(),n.set(f,e,g.getFilter(f),g.getSort(f)),void n.setOffset({left:h,top:c+p+2})}e.shiftKey||(o?t.showAutofill(u,f):Ws.call(this,!1,u,f),te(window,(e=>{({ri:u,ci:f}=s.getCellRectByXY(e.offsetX,e.offsetY)),o?t.showAutofill(u,f):1!==e.buttons||e.shiftKey||Ws.call(this,!0,u,f,!0,!0)}),(()=>{o&&t.arange&&"read"!==s.settings.mode&&s.autofill(t.arange,"all",(e=>Ms("Tip",e)))&&i.render(),t.hideAutofill(),ei.call(this)}))),o||1!==e.buttons||e.shiftKey&&Ws.call(this,!0,u,f)}function si(){const{editor:e,data:t}=this,s=t.getSelectedRect(),i=this.getTableOffset();let n="top";s.top>i.height/2&&(n="bottom"),e.setOffset(s,n)}function ii(){const{editor:e,data:t}=this;"read"!==t.settings.mode&&(si.call(this),e.setCell(t.getSelectedCell(),t.getSelectedValidator()),Ys.call(this))}function ni(e){const{data:t,table:s,selector:i}=this;t.scrolly(e,(()=>{i.resetBRLAreaOffset(),si.call(this),s.render()}))}function ri(e){const{data:t,table:s,selector:i}=this;t.scrollx(e,(()=>{i.resetBRTAreaOffset(),si.call(this),s.render()}))}function li(e,t){const{ri:s}=e,{table:i,selector:n,data:r}=this;r.rows.setHeight(s,t),i.render(),n.resetAreaOffset(),Ls.call(this),si.call(this)}function oi(e,t){const{ci:s}=e,{table:i,selector:n,data:r}=this;r.cols.setWidth(s,t),i.render(),n.resetAreaOffset(),Bs.call(this),si.call(this)}function ai(e,t="finished"){const{data:s,table:i}=this;if("read"===s.settings.mode)return;s.setSelectedCellText(e,t);const{ri:n,ci:r}=s.selector;"finished"===t?i.render():this.trigger("cell-edited",e,n,r)}function hi(e){const{data:t}=this;"read"!==t.settings.mode&&("insert-row"===e?t.insert("row"):"delete-row"===e?t.delete("row"):"insert-column"===e?t.insert("column"):"delete-column"===e?t.delete("column"):"delete-cell"===e?t.deleteCell():"delete-cell-format"===e?t.deleteCell("format"):"delete-cell-text"===e?t.deleteCell("text"):"cell-printable"===e?t.setSelectedCellAttr("printable",!0):"cell-non-printable"===e?t.setSelectedCellAttr("printable",!1):"cell-editable"===e?t.setSelectedCellAttr("editable",!0):"cell-non-editable"===e&&t.setSelectedCellAttr("editable",!1),Ys.call(this),Us.call(this))}function ci(e,t){const{data:s}=this;if("undo"===e)this.undo();else if("redo"===e)this.redo();else if("print"===e)this.print.preview();else if("paintformat"===e)!0===t?Xs.call(this):Ys.call(this);else if("clearformat"===e)hi.call(this,"delete-cell-format");else if("link"===e);else if("chart"===e);else if("autofilter"===e)Qs.call(this);else if("freeze"===e)if(t){const{ri:e,ci:t}=s.selector;this.freeze(e,t)}else this.freeze(0,0);else s.setSelectedCellAttr(e,t),"formula"!==e||s.selector.multiple()||ii.call(this),Us.call(this)}function di(e,t,s,i){this.data.setAutoFilter(e,t,s,i),Us.call(this)}function pi(){const{selector:e,overlayerEl:t,rowResizer:s,colResizer:i,verticalScrollbar:n,horizontalScrollbar:r,editor:l,contextMenu:o,toolbar:a,modalValidation:h,sortFilter:c}=this;t.on("mousemove",(e=>{_s.call(this,e)})).on("mousedown",(e=>{l.clear(),o.hide(),2===e.buttons?(this.data.xyInSelectedRect(e.offsetX,e.offsetY)||ti.call(this,e),o.setPosition(e.offsetX,e.offsetY),e.stopPropagation()):2===e.detail?ii.call(this):ti.call(this,e)})).on("mousewheel.stop",(e=>{Ps.call(this,e)})).on("mouseout",(e=>{const{offsetX:t,offsetY:n}=e;n<=0&&i.hide(),t<=0&&s.hide()})),e.inputChange=e=>{ai.call(this,e,"input"),ii.call(this)},function(e,{move:t,end:s}){let i=0,n=0;K(e,"touchstart",(e=>{const{pageX:t,pageY:s}=e.touches[0];i=t,n=s})),K(e,"touchmove",(e=>{if(!t)return;const{pageX:s,pageY:r}=e.changedTouches[0],l=s-i,o=r-n;(Math.abs(l)>10||Math.abs(o)>10)&&(se(l,o,e,t),i=s,n=r),e.preventDefault()})),K(e,"touchend",(e=>{if(!s)return;const{pageX:t,pageY:r}=e.changedTouches[0];se(t-i,r-n,e,s)}))}(t.el,{move:(e,t)=>{qs.call(this,e,t)}}),a.change=(e,t)=>ci.call(this,e,t),c.ok=(e,t,s,i)=>di.call(this,e,t,s,i),s.finishedFn=(e,t)=>{li.call(this,e,t)},i.finishedFn=(e,t)=>{oi.call(this,e,t)},s.unhideFn=e=>{Gs.call(this,"row",e)},i.unhideFn=e=>{Gs.call(this,"col",e)},n.moveFn=(e,t)=>{ni.call(this,e,t)},r.moveFn=(e,t)=>{ri.call(this,e,t)},l.change=(e,t)=>{ai.call(this,t,e)},h.change=(e,...t)=>{"save"===e?this.data.addValidation(...t):this.data.removeValidation()},o.itemClick=e=>{"validation"===e?h.setValue(this.data.getSelectedValidation()):"copy"===e?Xs.call(this):"cut"===e?Zs.call(this):"paste"===e?Js.call(this,"all"):"paste-value"===e?Js.call(this,"text"):"paste-format"===e?Js.call(this,"format"):"hide"===e?Ks.call(this):hi.call(this,e)},K(window,"resize",(()=>{this.reload()})),K(window,"click",(e=>{this.focusing=t.contains(e.target)})),K(window,"paste",(e=>{this.focusing&&(Js.call(this,"all",e),e.preventDefault())})),K(window,"keydown",(e=>{if(!this.focusing)return;const t=e.keyCode||e.which,{key:s,ctrlKey:i,shiftKey:n,metaKey:r}=e;if(i||r)switch(t){case 90:this.undo(),e.preventDefault();break;case 89:this.redo(),e.preventDefault();break;case 67:Xs.call(this),e.preventDefault();break;case 88:Zs.call(this),e.preventDefault();break;case 85:a.trigger("underline"),e.preventDefault();break;case 86:default:break;case 37:Vs.call(this,n,"row-first"),e.preventDefault();break;case 38:Vs.call(this,n,"col-first"),e.preventDefault();break;case 39:Vs.call(this,n,"row-last"),e.preventDefault();break;case 40:Vs.call(this,n,"col-last"),e.preventDefault();break;case 32:Ws.call(this,!1,-1,this.data.selector.ci,!1),e.preventDefault();break;case 66:a.trigger("bold");break;case 73:a.trigger("italic")}else{switch(t){case 32:n&&Ws.call(this,!1,this.data.selector.ri,-1,!1);break;case 27:o.hide(),Ys.call(this);break;case 37:Vs.call(this,n,"left"),e.preventDefault();break;case 38:Vs.call(this,n,"up"),e.preventDefault();break;case 39:Vs.call(this,n,"right"),e.preventDefault();break;case 40:Vs.call(this,n,"down"),e.preventDefault();break;case 9:l.clear(),Vs.call(this,!1,n?"left":"right"),e.preventDefault();break;case 13:l.clear(),Vs.call(this,!1,n?"up":"down"),e.preventDefault();break;case 8:hi.call(this,"delete-cell-text"),e.preventDefault()}"Delete"===s?(hi.call(this,"delete-cell-text"),e.preventDefault()):t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||"="===e.key?(ai.call(this,e.key,"input"),ii.call(this)):113===t&&ii.call(this)}}))}class ui{constructor(e,s){this.eventMap=function(){const e=new Map;function t(t,s){return e.has(t)&&(()=>{const i=e.get(t);return Array.isArray(i)&&i.push(s)||!1})()||e.set(t,[].concat(s))}function s(t,s){return e.has(t)&&(()=>{const i=e.get(t),n=i.indexOf(s);return n>=0&&i.splice(n,1)&&0===e.get(t).length&&e.delete(t)})()}return{get current(){return e},on:t,once:function(e,i){const n=(...t)=>{i.call(null,...t),s(e,n)};return t(e,n)},fire:function(t,s){return e.has(t)&&(()=>{const i=e.get(t);for(const e of i)e.call(null,...s)})()},removeListener:s,removeAllListeners:function(){e.clear()}}}();const{view:i,showToolbar:n,showContextmenu:r}=s.settings;this.el=t("div",`${ie}-sheet`),this.toolbar=new Es(s,i.width,!n),this.print=new Et(s),e.children(this.toolbar.el,this.el,this.print.el),this.data=s,this.tableEl=t("canvas",`${ie}-table`),this.rowResizer=new ne(!1,s.rows.height),this.colResizer=new ne(!0,s.cols.minWidth),this.verticalScrollbar=new re(!0),this.horizontalScrollbar=new re(!1),this.editor=new _e(tt,(()=>this.getTableOffset()),s.rows.height),this.modalValidation=new Ds,this.contextMenu=new Tt((()=>this.getRect()),!r),this.selector=new ye(s),this.overlayerCEl=t("div",`${ie}-overlayer-content`).children(this.editor.el,this.selector.el),this.overlayerEl=t("div",`${ie}-overlayer`).child(this.overlayerCEl),this.sortFilter=new Hs,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new class{constructor(e,t){this.el=e,this.draw=new Xe(e,t.viewWidth(),t.viewHeight()),this.data=t}resetData(e){this.data=e,this.render()}render(){const{data:e}=this,{rows:t,cols:s}=e,i=s.indexWidth,n=t.height;this.draw.resize(e.viewWidth(),e.viewHeight()),this.clear();const r=e.viewRange(),l=e.freezeTotalWidth(),o=e.freezeTotalHeight(),{x:a,y:h}=e.scroll;xt.call(this,r,i,n,l,o),pt.call(this,r,i,n,-a,-h),ft.call(this,"all",r,i,n,l,o),gt.call(this,i,n);const[c,d]=e.freeze;if(c>0||d>0){if(c>0){const e=r.clone();e.sri=0,e.eri=c-1,e.h=o,xt.call(this,e,i,n,l,0),pt.call(this,e,i,n,-a,0),ft.call(this,"top",e,i,n,l,0)}if(d>0){const e=r.clone();e.sci=0,e.eci=d-1,e.w=l,xt.call(this,e,i,n,0,o),ft.call(this,"left",e,i,n,0,o),pt.call(this,e,i,n,0,-h)}const t=e.freezeViewRange();xt.call(this,t,i,n,0,0),ft.call(this,"all",t,i,n,0,0),pt.call(this,t,i,n,0,0),mt.call(this,i,n,l,o)}}clear(){this.draw.clear()}}(this.tableEl.el,s),pi.call(this),Us.call(this),Ws.call(this,!1,0,0)}on(e,t){return this.eventMap.on(e,t),this}trigger(e,...t){const{eventMap:s}=this;s.fire(e,t)}resetData(e){this.editor.clear(),this.data=e,Ls.call(this),Bs.call(this),this.toolbar.resetData(e),this.print.resetData(e),this.selector.resetData(e),this.table.resetData(e)}loadData(e){return this.data.setData(e),Us.call(this),this}freeze(e,t){const{data:s}=this;return s.setFreeze(e,t),Us.call(this),this}undo(){this.data.undo(),Us.call(this)}redo(){this.data.redo(),Us.call(this)}reload(){return Us.call(this),this}getRect(){const{data:e}=this;return{width:e.viewWidth(),height:e.viewHeight()}}getTableOffset(){const{rows:e,cols:t}=this.data,{width:s,height:i}=this.getRect();return{width:s-t.indexWidth,height:i-e.height,left:t.indexWidth,top:e.height}}}class fi extends Rt{constructor(e){super(new ze("ellipsis"),"auto",!1,"top-left"),this.contentClick=e}reset(e){const s=e.map(((e,s)=>t("div",`${ie}-item`).css("width","150px").css("font-weight","normal").on("click",(()=>{this.contentClick(s),this.hide()})).child(e)));this.setContentChildren(...s)}setTitle(){}}const gi=[{key:"delete",title:H("contextmenu.deleteSheet")}];function xi(e){return t("div",`${ie}-item`).child(e.title()).on("click",(()=>{this.itemClick(e.key),this.hide()}))}function mi(){return gi.map((e=>xi.call(this,e)))}class bi{constructor(){this.el=t("div",`${ie}-contextmenu`).css("width","160px").children(...mi.call(this)).hide(),this.itemClick=()=>{}}hide(){const{el:e}=this;e.hide(),Q(e)}setOffset(e){const{el:t}=this;t.offset(e),t.show(),ee(t)}}class wi{constructor(e=(()=>{}),s=(()=>{}),i=(()=>{}),n=(()=>{})){this.swapFunc=s,this.updateFunc=n,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new fi((e=>{this.clickSwap2(this.items[e])})),this.contextMenu=new bi,this.contextMenu.itemClick=i,this.el=t("div",`${ie}-bottombar`).children(this.contextMenu.el,this.menuEl=t("ul",`${ie}-menu`).child(t("li","").children(new ze("add").on("click",(()=>{e()})),t("span","").child(this.moreEl))))}addItem(e,s){this.dataNames.push(e);const i=t("li",s?"active":"").child(e);i.on("click",(()=>{this.clickSwap2(i)})).on("contextmenu",(e=>{const{offsetLeft:t,offsetHeight:s}=e.target;this.contextMenu.setOffset({left:t,bottom:s+1}),this.deleteEl=i})).on("dblclick",(()=>{const e=i.html(),t=new Ss("auto","");t.val(e),t.input.on("blur",(({target:t})=>{const{value:s}=t,i=this.dataNames.findIndex((t=>t===e));this.renameItem(i,s)})),i.html("").child(t.el),t.focus()})),s&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}renameItem(e,t){this.dataNames.splice(e,1,t),this.moreEl.reset(this.dataNames),this.items[e].html("").child(t),this.updateFunc(e,t)}clear(){this.items.forEach((e=>{this.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}deleteItem(){const{activeEl:e,deleteEl:t}=this;if(this.items.length>1){const s=this.items.findIndex((e=>e===t));if(this.items.splice(s,1),this.dataNames.splice(s,1),this.menuEl.removeChild(t.el),this.moreEl.reset(this.dataNames),e===t){const[e]=this.items;return this.activeEl=e,this.activeEl.toggle(),[s,0]}return[s,-1]}return[-1]}clickSwap2(e){const t=this.items.findIndex((t=>t===e));this.clickSwap(e),this.activeEl.toggle(),this.swapFunc(t)}clickSwap(e){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=e}}var vi=s(379),yi=s.n(vi),ki=s(795),Ci=s.n(ki),Ei=s(569),Si=s.n(Ei),$i=s(565),zi=s.n($i),Ti=s(216),Di=s.n(Ti),Oi=s(589),Ri=s.n(Oi),Ai=s(176),Ii={};Ii.styleTagTransform=Ri(),Ii.setAttributes=zi(),Ii.insert=Si().bind(null,"head"),Ii.domAPI=Ci(),Ii.insertStyleElement=Di(),yi()(Ai.Z,Ii),Ai.Z&&Ai.Z.locals&&Ai.Z.locals;class Hi{constructor(e,s={}){let i=e;this.options={showBottomBar:!0,...s},this.sheetIndex=1,this.datas=[],"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new wi((()=>{const e=this.addSheet();this.sheet.resetData(e)}),(e=>{const t=this.datas[e];this.sheet.resetData(t)}),(()=>{this.deleteSheet()}),((e,t)=>{this.datas[e].name=t})):null,this.data=this.addSheet();const n=t("div",`${ie}`).on("contextmenu",(e=>e.preventDefault()));i.appendChild(n.el),this.sheet=new ui(n,this.data),null!==this.bottombar&&n.child(this.bottombar.el)}addSheet(e,t=!0){const s=e||`sheet${this.sheetIndex}`,i=new J(s,this.options);return i.change=(...e)=>{this.sheet.trigger("change",...e)},this.datas.push(i),null!==this.bottombar&&this.bottombar.addItem(s,t),this.sheetIndex+=1,i}deleteSheet(){if(null===this.bottombar)return;const[e,t]=this.bottombar.deleteItem();e>=0&&(this.datas.splice(e,1),t>=0&&this.sheet.resetData(this.datas[t]))}loadData(e){const t=Array.isArray(e)?e:[e];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],t.length>0)for(let e=0;e<t.length;e+=1){const s=t[e],i=this.addSheet(s.name,0===e);i.setData(s),0===e&&this.sheet.resetData(i)}return this}getData(){return this.datas.map((e=>e.getData()))}cellText(e,t,s,i=0){return this.datas[i].setCellText(e,t,s,"finished"),this}cell(e,t,s=0){return this.datas[s].getCell(e,t)}cellStyle(e,t,s=0){return this.datas[s].getCellStyle(e,t)}reRender(){return this.sheet.table.render(),this}on(e,t){return this.sheet.on(e,t),this}validate(){const{validations:e}=this.data;return e.errors.size<=0}change(e){return this.sheet.on("change",e),this}static locale(e,t){M(e,t)}}const Mi=(e,t={})=>new Hi(e,t);window&&(window.x_spreadsheet=Mi,window.x_spreadsheet.locale=(e,t)=>M(e,t));const Ni=Hi})(),Spreadsheet=i})();